{"file_contents":{"FlipkartClone/services/reviews.py":{"content":"from models import db, Review, Product\nfrom sqlalchemy import func\n\ndef add_review(product_id, user_id, rating, comment=''):\n    \"\"\"Add a product review and update product rating\"\"\"\n    existing_review = Review.query.filter_by(\n        product_id=product_id, \n        user_id=user_id\n    ).first()\n    \n    if existing_review:\n        existing_review.rating = rating\n        existing_review.comment = comment\n    else:\n        review = Review(\n            product_id=product_id,\n            user_id=user_id,\n            rating=rating,\n            comment=comment\n        )\n        db.session.add(review)\n    \n    update_product_rating(product_id)\n    db.session.commit()\n    return True\n\ndef update_product_rating(product_id):\n    \"\"\"Recalculate and update product's average rating\"\"\"\n    result = db.session.query(\n        func.avg(Review.rating),\n        func.count(Review.id)\n    ).filter(Review.product_id == product_id).first()\n    \n    avg_rating, count = result\n    \n    product = Product.query.filter_by(product_id=product_id).first()\n    if product:\n        product.rating = round(avg_rating, 1) if avg_rating else 0.0\n        product.rating_count = count if count else 0\n        db.session.commit()\n\ndef get_product_reviews(product_id, limit=10):\n    \"\"\"Get reviews for a product\"\"\"\n    return Review.query.filter_by(product_id=product_id).order_by(\n        Review.created_at.desc()\n    ).limit(limit).all()\n","size_bytes":1418},"FlipkartClone/services/__init__.py":{"content":"","size_bytes":0},"FlipkartClone/services/geolocation.py":{"content":"import math\n\ndef haversine_distance(lat1, lon1, lat2, lon2):\n    \"\"\"\n    Calculate the great circle distance between two points \n    on the earth (specified in decimal degrees)\n    Returns distance in kilometers\n    \"\"\"\n    R = 6371\n    \n    lat1_rad = math.radians(lat1)\n    lat2_rad = math.radians(lat2)\n    dlat = math.radians(lat2 - lat1)\n    dlon = math.radians(lon2 - lon1)\n    \n    a = (math.sin(dlat / 2) ** 2 + \n         math.cos(lat1_rad) * math.cos(lat2_rad) * \n         math.sin(dlon / 2) ** 2)\n    c = 2 * math.asin(math.sqrt(a))\n    \n    return R * c\n\ndef get_distance_display(distance_km):\n    \"\"\"Convert distance to human-readable format\"\"\"\n    if distance_km < 1:\n        return f\"{int(distance_km * 1000)} m\"\n    return f\"{distance_km:.1f} km\"\n","size_bytes":762},"FlipkartClone/services/inventory.py":{"content":"from models import db, Product\n\ndef check_stock_availability(product_id, quantity, purchase_option='delivery'):\n    \"\"\"\n    Check if product has sufficient stock for the purchase option\n    purchase_option: 'delivery', 'pickup', 'in-store'\n    \"\"\"\n    product = Product.query.filter_by(product_id=product_id).first()\n    if not product:\n        return False, \"Product not found\"\n    \n    if purchase_option == 'delivery':\n        if product.online_stock >= quantity:\n            return True, \"Available for delivery\"\n        return False, f\"Only {product.online_stock} available for delivery\"\n    \n    elif purchase_option in ['pickup', 'in-store']:\n        if product.stock >= quantity:\n            return True, f\"Available for {purchase_option}\"\n        return False, f\"Only {product.stock} available in store\"\n    \n    return False, \"Invalid purchase option\"\n\ndef decrement_stock(product_id, quantity, purchase_option='delivery'):\n    \"\"\"Decrement stock based on purchase option\"\"\"\n    product = Product.query.filter_by(product_id=product_id).first()\n    if not product:\n        return False\n    \n    if purchase_option == 'delivery':\n        if product.online_stock >= quantity:\n            product.online_stock -= quantity\n            product.stock -= quantity\n            db.session.commit()\n            return True\n    else:\n        if product.stock >= quantity:\n            product.stock -= quantity\n            db.session.commit()\n            return True\n    \n    return False\n\ndef update_product_inventory(product_id, total_stock, online_stock):\n    \"\"\"Update product inventory levels\"\"\"\n    product = Product.query.filter_by(product_id=product_id).first()\n    if not product:\n        return False\n    \n    if online_stock > total_stock:\n        online_stock = total_stock\n    \n    product.stock = total_stock\n    product.online_stock = online_stock\n    db.session.commit()\n    return True\n","size_bytes":1900},"FlipkartClone/app.py":{"content":"from flask import Flask, render_template, request, jsonify, redirect, url_for, make_response\nfrom flask_mail import Mail, Message\nfrom werkzeug.security import generate_password_hash, check_password_hash\nfrom werkzeug.utils import secure_filename\nimport os\nimport json\nimport secrets\nfrom datetime import datetime\nimport math\nfrom apscheduler.schedulers.background import BackgroundScheduler\n\nfrom models import db, User, Product, Cart, Order, Address, TempUser, AuthToken, Review, RoutePlan, RoutePlanStop\nfrom database import init_db, cleanup_expired_temp_users\nfrom auth import create_temp_user, verify_and_move_user, create_auth_token, verify_token, logout_user, create_logout_token, verify_logout_token\n\napp = Flask(__name__)\napp.config['SECRET_KEY'] = os.environ.get('SESSION_SECRET', secrets.token_hex(32))\napp.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///ecommerce.db'\napp.config['SQLALCHEMY_TRACK_MODIFICATIONS'] = False\napp.config['UPLOAD_FOLDER'] = 'static/uploads'\napp.config['MAX_CONTENT_LENGTH'] = 16 * 1024 * 1024\n\napp.config['MAIL_SERVER'] = os.environ.get('MAIL_SERVER', 'smtp.gmail.com')\napp.config['MAIL_PORT'] = int(os.environ.get('MAIL_PORT', 587))\napp.config['MAIL_USE_TLS'] = os.environ.get('MAIL_USE_TLS', 'True') == 'True'\napp.config['MAIL_USERNAME'] = os.environ.get('MAIL_USERNAME', '')\napp.config['MAIL_PASSWORD'] = os.environ.get('MAIL_PASSWORD', '')\napp.config['MAIL_DEFAULT_SENDER'] = os.environ.get('MAIL_DEFAULT_SENDER', 'noreply@buddyshop.com')\n\ndb.init_app(app)\nmail = Mail(app)\n\nos.makedirs(app.config['UPLOAD_FOLDER'], exist_ok=True)\n\ninit_db(app)\n\nscheduler = BackgroundScheduler()\nscheduler.add_job(func=cleanup_expired_temp_users, trigger=\"interval\", minutes=5)\nscheduler.start()\n\nALLOWED_EXTENSIONS = {'png', 'jpg', 'jpeg', 'gif', 'webp'}\n\ndef allowed_file(filename):\n    return '.' in filename and filename.rsplit('.', 1)[1].lower() in ALLOWED_EXTENSIONS\n\ndef get_current_user():\n    token = request.cookies.get('auth_token')\n    user_id = request.cookies.get('user_id')\n\n    if token and user_id:\n        verified_user_id = verify_token(token)\n        if verified_user_id == user_id:\n            user = User.query.filter_by(user_id=user_id).first()\n            if user:\n                return {\n                    'id': user.id,\n                    'user_id': user.user_id,\n                    'email': user.email,\n                    'full_name': user.full_name,\n                    'phone': user.phone,\n                    'user_type': user.user_type,\n                    'login_status': user.login_status,\n                    'shop_name': user.shop_name,\n                    'shop_address': user.shop_address,\n                    'shop_latitude': user.shop_latitude,\n                    'shop_longitude': user.shop_longitude,\n                    'shop_city': user.shop_city,\n                    'shop_pincode': user.shop_pincode\n                }\n    return None\n\ndef calculate_distance(lat1, lon1, lat2, lon2):\n    R = 6371\n    \n    dlat = math.radians(lat2 - lat1)\n    dlon = math.radians(lon2 - lon1)\n    \n    a = math.sin(dlat / 2) ** 2 + math.cos(math.radians(lat1)) * math.cos(math.radians(lat2)) * math.sin(dlon / 2) ** 2\n    c = 2 * math.asin(math.sqrt(a))\n    \n    return R * c\n\n@app.route('/')\ndef onboarding():\n    return render_template('onboarding.html')\n\n@app.route('/home')\ndef index():\n    user = get_current_user()\n    mode = request.args.get('mode', 'global')\n    user_lat = request.args.get('lat', type=float)\n    user_lng = request.args.get('lng', type=float)\n    \n    query = Product.query.filter_by(is_visible=1)\n    \n    if mode == 'local' and user_lat is not None and user_lng is not None:\n        all_products = query.order_by(Product.created_at.desc()).all()\n        nearby_products = []\n        \n        for product in all_products:\n            seller = User.query.filter_by(user_id=product.seller_id).first()\n            if seller and seller.shop_latitude is not None and seller.shop_longitude is not None and seller.shop_latitude != 0.0 and seller.shop_longitude != 0.0:\n                distance = calculate_distance(user_lat, user_lng, seller.shop_latitude, seller.shop_longitude)\n                if distance <= 30:\n                    product.distance = round(distance, 1)\n                    product.seller_shop_name = seller.shop_name\n                    nearby_products.append(product)\n        \n        products = sorted(nearby_products, key=lambda x: x.distance)\n    else:\n        products = query.order_by(Product.created_at.desc()).limit(20).all()\n        for product in products:\n            product.distance = None\n            seller = User.query.filter_by(user_id=product.seller_id).first()\n            if seller:\n                product.seller_shop_name = seller.shop_name\n    \n    products_data = []\n    for product in products:\n        if product.images:\n            try:\n                images = json.loads(product.images) if product.images.startswith('[') else [product.images]\n            except (json.JSONDecodeError, AttributeError):\n                images = [product.images] if product.images else []\n        else:\n            images = []\n        \n        product_dict = {\n            'id': product.id,\n            'product_id': product.product_id,\n            'name': product.name,\n            'description': product.description,\n            'category': product.category,\n            'price': product.price,\n            'stock': product.stock,\n            'images': images,\n            'distance': product.distance if hasattr(product, 'distance') else None,\n            'seller_shop_name': product.seller_shop_name if hasattr(product, 'seller_shop_name') else None\n        }\n        products_data.append(product_dict)\n    \n    return render_template('index.html', products=products_data, user=user, mode=mode)\n\ndef validate_password(password):\n    if len(password) < 8:\n        return False, \"Password must be at least 8 characters long\"\n    if not any(c.isupper() for c in password):\n        return False, \"Password must contain at least one capital letter\"\n    if not any(c.isdigit() for c in password):\n        return False, \"Password must contain at least one number\"\n    return True, \"Valid\"\n\n@app.route('/register', methods=['GET', 'POST'])\ndef register():\n    if request.method == 'POST':\n        data = request.json\n        email = data.get('email')\n        password = data.get('password')\n        full_name = data.get('full_name')\n        phone = data.get('phone')\n        user_type = data.get('user_type', 'buyer')\n\n        is_valid, message = validate_password(password)\n        if not is_valid:\n            return jsonify({'success': False, 'message': message})\n\n        password_hash = generate_password_hash(password)\n        user_id = create_temp_user(email, password_hash, full_name, phone, user_type)\n\n        if user_id:\n            verification_link = f\"{request.host_url}verify/{user_id}\"\n\n            try:\n                msg = Message('Verify Your Email - Local Trade', recipients=[email])\n                msg.html = f'''\n                <h2>Welcome to Local Trade!</h2>\n                <p>Hi {full_name},</p>\n                <p>Thank you for registering. Please verify your email within 15 minutes by clicking the link below:</p>\n                <p><a href=\"{verification_link}\" style=\"background-color: #2874f0; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px;\">Verify Email</a></p>\n                <p>If the button doesn't work, copy and paste this link: {verification_link}</p>\n                <p>This link will expire in 15 minutes.</p>\n                '''\n                mail.send(msg)\n                return jsonify({'success': True, 'message': 'Registration successful! Check your email to verify.'})\n            except Exception as e:\n                return jsonify({'success': True, 'message': 'Registration successful! (Email service not configured)', 'user_id': user_id})\n        else:\n            return jsonify({'success': False, 'message': 'Email already registered'})\n\n    return render_template('register.html')\n\n@app.route('/verify/<user_id>')\ndef verify_email(user_id):\n    if verify_and_move_user(user_id):\n        return render_template('verified.html', success=True)\n    else:\n        return render_template('verified.html', success=False)\n\n@app.route('/login', methods=['GET', 'POST'])\ndef login():\n    if request.method == 'POST':\n        data = request.json\n        email = data.get('email')\n        password = data.get('password')\n        force_login = data.get('force_login', False)\n\n        user = User.query.filter_by(email=email).first()\n\n        if user and check_password_hash(user.password_hash, password):\n            if user.login_status == 1 and not force_login:\n                try:\n                    msg = Message('New Login Attempt', recipients=[user.email])\n                    msg.html = f'''\n                    <h2>New Login Attempt Detected</h2>\n                    <p>Hi {user.full_name},</p>\n                    <p>Someone is trying to log into your account from a new device/browser.</p>\n                    <p>If this was you, please confirm the login in your browser.</p>\n                    <p>If this wasn't you, your account may be at risk. Please change your password immediately.</p>\n                    '''\n                    mail.send(msg)\n                except:\n                    pass\n                \n                return jsonify({'success': False, 'message': 'Account already logged in elsewhere', 'already_logged_in': True})\n            \n            token = create_auth_token(user.user_id)\n\n            response = make_response(jsonify({\n                'success': True,\n                'message': 'Login successful!',\n                'user': {\n                    'user_id': user.user_id,\n                    'email': user.email,\n                    'full_name': user.full_name,\n                    'user_type': user.user_type\n                }\n            }))\n\n            response.set_cookie('user_id', user.user_id, max_age=30 * 24 * 60 * 60, httponly=True)\n            response.set_cookie('auth_token', token, max_age=30 * 24 * 60 * 60, httponly=True)\n\n            return response\n        else:\n            return jsonify({'success': False, 'message': 'Invalid credentials'})\n\n    return render_template('login.html')\n\n@app.route('/logout', methods=['POST'])\ndef logout_route():\n    user = get_current_user()\n\n    if user:\n        logout_user(user['user_id'])\n        response = make_response(jsonify({'success': True, 'message': 'Logged out successfully'}))\n        response.delete_cookie('user_id')\n        response.delete_cookie('auth_token')\n        return response\n\n    return jsonify({'success': False, 'message': 'Not logged in'})\n\n@app.route('/forgot-password', methods=['GET', 'POST'])\ndef forgot_password():\n    if request.method == 'POST':\n        data = request.json\n        email = data.get('email')\n        \n        user = User.query.filter_by(email=email).first()\n        \n        if user:\n            reset_token = create_logout_token(user.user_id)\n            reset_link = f\"{request.host_url}reset-password/{reset_token}\"\n            \n            try:\n                msg = Message('Password Reset Request', recipients=[email])\n                msg.html = f'''\n                <h2>Password Reset Request</h2>\n                <p>Hi {user.full_name},</p>\n                <p>Click the link below to reset your password:</p>\n                <p><a href=\"{reset_link}\" style=\"background-color: #2874f0; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px;\">Reset Password</a></p>\n                <p>This link will expire in 15 minutes.</p>\n                <p>If you didn't request this, please ignore this email.</p>\n                '''\n                mail.send(msg)\n                return jsonify({'success': True, 'message': 'Password reset link sent to your email'})\n            except:\n                return jsonify({'success': False, 'message': 'Email service not configured'})\n        else:\n            return jsonify({'success': True, 'message': 'If email exists, reset link has been sent'})\n    \n    return render_template('forgot_password.html')\n\n@app.route('/reset-password/<token>', methods=['GET', 'POST'])\ndef reset_password(token):\n    if request.method == 'POST':\n        data = request.json\n        new_password = data.get('password')\n        \n        is_valid, message = validate_password(new_password)\n        if not is_valid:\n            return jsonify({'success': False, 'message': message})\n        \n        user_id = verify_logout_token(token)\n        \n        if user_id:\n            password_hash = generate_password_hash(new_password)\n            user = User.query.filter_by(user_id=user_id).first()\n            if user:\n                user.password_hash = password_hash\n                user.login_status = 0\n                \n                AuthToken.query.filter_by(user_id=user_id).update({'is_active': 0})\n                db.session.commit()\n                \n                return jsonify({'success': True, 'message': 'Password reset successful! Please login.'})\n        \n        return jsonify({'success': False, 'message': 'Invalid or expired reset link'})\n    \n    user_id = verify_logout_token(token)\n    if user_id:\n        return render_template('reset_password.html', token=token)\n    else:\n        return render_template('verified.html', success=False)\n\n@app.route('/products')\ndef products():\n    category = request.args.get('category')\n    search = request.args.get('search')\n    mode = request.args.get('mode', 'global')\n    user_lat = request.args.get('lat', type=float)\n    user_lng = request.args.get('lng', type=float)\n\n    query = Product.query.filter_by(is_visible=1)\n\n    if category:\n        query = query.filter_by(category=category)\n\n    if search:\n        search_filter = f'%{search}%'\n        query = query.filter(\n            (Product.name.like(search_filter)) |\n            (Product.description.like(search_filter)) |\n            (Product.category.like(search_filter))\n        )\n\n    if mode == 'local' and user_lat is not None and user_lng is not None:\n        all_products = query.order_by(Product.created_at.desc()).all()\n        nearby_products = []\n        \n        for product in all_products:\n            seller = User.query.filter_by(user_id=product.seller_id).first()\n            if seller and seller.shop_latitude is not None and seller.shop_longitude is not None and seller.shop_latitude != 0.0 and seller.shop_longitude != 0.0:\n                distance = calculate_distance(user_lat, user_lng, seller.shop_latitude, seller.shop_longitude)\n                if distance <= 30:\n                    product.distance = round(distance, 1)\n                    product.seller_shop_name = seller.shop_name\n                    nearby_products.append(product)\n        \n        products_list = sorted(nearby_products, key=lambda x: x.distance)\n    else:\n        products_list = query.order_by(Product.created_at.desc()).all()\n        for product in products_list:\n            product.distance = None\n            seller = User.query.filter_by(user_id=product.seller_id).first()\n            if seller:\n                product.seller_shop_name = seller.shop_name\n\n    products_data = []\n    for product in products_list:\n        product_dict = {\n            'id': product.id,\n            'product_id': product.product_id,\n            'name': product.name,\n            'description': product.description,\n            'category': product.category,\n            'price': product.price,\n            'stock': product.stock,\n            'images': json.loads(product.images) if product.images else [],\n            'distance': product.distance if hasattr(product, 'distance') else None,\n            'seller_shop_name': product.seller_shop_name if hasattr(product, 'seller_shop_name') else None\n        }\n        products_data.append(product_dict)\n\n    user = get_current_user()\n    return render_template('products.html', products=products_data, user=user, mode=mode)\n\n@app.route('/product/<product_id>')\ndef product_detail(product_id):\n    product = Product.query.filter_by(product_id=product_id).first()\n\n    if product:\n        seller = User.query.filter_by(user_id=product.seller_id).first()\n        product_dict = {\n            'id': product.id,\n            'product_id': product.product_id,\n            'name': product.name,\n            'description': product.description,\n            'category': product.category,\n            'price': product.price,\n            'stock': product.stock,\n            'images': json.loads(product.images) if product.images else [],\n            'seller_shop_name': seller.shop_name if seller else None,\n            'seller_shop_address': seller.shop_address if seller else None,\n            'seller_shop_latitude': seller.shop_latitude if seller else None,\n            'seller_shop_longitude': seller.shop_longitude if seller else None\n        }\n\n        user = get_current_user()\n        return render_template('product_detail.html', product=product_dict, user=user)\n    else:\n        return \"Product not found\", 404\n\n@app.route('/seller/dashboard')\ndef seller_dashboard():\n    user = get_current_user()\n\n    if not user or user['user_type'] != 'seller':\n        return redirect(url_for('login'))\n\n    products = Product.query.filter_by(seller_id=user['user_id']).all()\n\n    products_data = []\n    for product in products:\n        product_dict = {\n            'id': product.id,\n            'product_id': product.product_id,\n            'name': product.name,\n            'description': product.description,\n            'category': product.category,\n            'price': product.price,\n            'stock': product.stock,\n            'images': json.loads(product.images) if product.images else [],\n            'is_visible': product.is_visible,\n            'expiry_date': product.expiry_date\n        }\n        products_data.append(product_dict)\n\n    return render_template('seller_dashboard.html', products=products_data, user=user)\n\n@app.route('/seller/update-shop-location', methods=['POST'])\ndef update_shop_location():\n    user = get_current_user()\n\n    if not user or user['user_type'] != 'seller':\n        return jsonify({'success': False, 'message': 'Unauthorized'}), 401\n\n    data = request.json\n    shop_name = data.get('shop_name')\n    shop_address = data.get('shop_address')\n    shop_latitude = data.get('shop_latitude')\n    shop_longitude = data.get('shop_longitude')\n    shop_city = data.get('shop_city')\n    shop_pincode = data.get('shop_pincode')\n\n    if shop_latitude is not None and shop_longitude is not None:\n        if shop_latitude == 0.0 and shop_longitude == 0.0:\n            return jsonify({'success': False, 'message': 'Invalid coordinates: 0,0 is not a valid shop location. Please enter your actual coordinates.'}), 400\n        if not (-90 <= shop_latitude <= 90) or not (-180 <= shop_longitude <= 180):\n            return jsonify({'success': False, 'message': 'Invalid coordinates: Latitude must be between -90 and 90, Longitude must be between -180 and 180.'}), 400\n\n    seller = User.query.filter_by(user_id=user['user_id']).first()\n    if seller:\n        seller.shop_name = shop_name\n        seller.shop_address = shop_address\n        seller.shop_latitude = shop_latitude\n        seller.shop_longitude = shop_longitude\n        seller.shop_city = shop_city\n        seller.shop_pincode = shop_pincode\n        db.session.commit()\n        return jsonify({'success': True, 'message': 'Shop location updated successfully'})\n\n    return jsonify({'success': False, 'message': 'User not found'})\n\n@app.route('/seller/add-product', methods=['GET', 'POST'])\ndef add_product():\n    user = get_current_user()\n\n    if not user or user['user_type'] != 'seller':\n        return jsonify({'success': False, 'message': 'Unauthorized'}), 401\n\n    if request.method == 'POST':\n        name = request.form.get('name')\n        description = request.form.get('description')\n        category = request.form.get('category')\n        price = float(request.form.get('price'))\n        stock = int(request.form.get('stock'))\n        expiry_date = request.form.get('expiry_date', '')\n        is_visible = request.form.get('is_visible', '1')\n\n        product_id = f\"PROD_{datetime.utcnow().strftime('%Y%m%d%H%M%S')}_{secrets.token_hex(4)}\"\n\n        image_paths = []\n        if 'images' in request.files:\n            files = request.files.getlist('images')\n            for file in files:\n                if file and allowed_file(file.filename):\n                    filename = secure_filename(f\"{product_id}_{secrets.token_hex(4)}_{file.filename}\")\n                    filepath = os.path.join(app.config['UPLOAD_FOLDER'], filename)\n                    file.save(filepath)\n                    image_paths.append(f\"/static/uploads/{filename}\")\n\n        new_product = Product(\n            product_id=product_id,\n            seller_id=user['user_id'],\n            name=name,\n            description=description,\n            category=category,\n            price=price,\n            stock=stock,\n            images=json.dumps(image_paths),\n            is_visible=int(is_visible),\n            expiry_date=expiry_date\n        )\n        db.session.add(new_product)\n        db.session.commit()\n\n        return jsonify({'success': True, 'message': 'Product added successfully!', 'product_id': product_id})\n\n    return render_template('add_product.html', user=user)\n\n@app.route('/seller/update-product/<product_id>', methods=['POST'])\ndef update_product(product_id):\n    user = get_current_user()\n\n    if not user or user['user_type'] != 'seller':\n        return jsonify({'success': False, 'message': 'Unauthorized'}), 401\n\n    data = request.json\n    product = Product.query.filter_by(product_id=product_id, seller_id=user['user_id']).first()\n    \n    if not product:\n        return jsonify({'success': False, 'message': 'Unauthorized or product not found'}), 403\n\n    if 'price' in data:\n        product.price = float(data['price'])\n    if 'stock' in data:\n        product.stock = int(data['stock'])\n    if 'online_stock' in data:\n        online_stock_value = max(0, min(int(data['online_stock']), product.stock))\n        product.online_stock = online_stock_value\n    if 'is_visible' in data:\n        product.is_visible = int(data['is_visible'])\n    if 'expiry_date' in data:\n        product.expiry_date = data['expiry_date']\n    \n    db.session.commit()\n\n    return jsonify({'success': True, 'message': 'Product updated successfully'})\n\n@app.route('/seller/orders')\ndef seller_orders():\n    user = get_current_user()\n\n    if not user or user['user_type'] != 'seller':\n        return redirect(url_for('login'))\n\n    all_orders = Order.query.order_by(Order.created_at.desc()).all()\n    seller_orders = []\n    \n    for order in all_orders:\n        products_data = json.loads(order.products)\n        seller_products = [p for p in products_data if Product.query.filter_by(product_id=p['product_id'], seller_id=user['user_id']).first()]\n        if seller_products:\n            order_dict = {\n                'order_id': order.order_id,\n                'user_id': order.user_id,\n                'products': seller_products,\n                'total_amount': order.total_amount,\n                'delivery_address': order.delivery_address,\n                'status': order.status,\n                'created_at': order.created_at\n            }\n            seller_orders.append(order_dict)\n\n    return render_template('seller_orders.html', orders=seller_orders, user=user)\n\n@app.route('/cart')\ndef cart():\n    user = get_current_user()\n\n    if not user:\n        return redirect(url_for('login'))\n\n    cart_items = db.session.query(Cart, Product).join(Product, Cart.product_id == Product.product_id).filter(Cart.user_id == user['user_id']).all()\n\n    cart_data = []\n    for cart_item, product in cart_items:\n        item_dict = {\n            'id': cart_item.id,\n            'product_id': cart_item.product_id,\n            'quantity': cart_item.quantity,\n            'name': product.name,\n            'price': product.price,\n            'images': json.loads(product.images) if product.images else []\n        }\n        cart_data.append(item_dict)\n\n    return render_template('cart.html', cart_items=cart_data, user=user)\n\n@app.route('/cart/add', methods=['POST'])\ndef add_to_cart():\n    user = get_current_user()\n\n    if not user:\n        return jsonify({'success': False, 'message': 'Please login first'}), 401\n\n    data = request.json\n    product_id = data.get('product_id')\n    quantity = data.get('quantity', 1)\n\n    existing = Cart.query.filter_by(user_id=user['user_id'], product_id=product_id).first()\n\n    if existing:\n        existing.quantity += quantity\n        message = 'Quantity updated in cart!'\n    else:\n        new_cart_item = Cart(user_id=user['user_id'], product_id=product_id, quantity=quantity)\n        db.session.add(new_cart_item)\n        message = 'Added to cart!'\n\n    db.session.commit()\n\n    return jsonify({'success': True, 'message': message})\n\n@app.route('/cart/check/<product_id>')\ndef check_cart(product_id):\n    user = get_current_user()\n\n    if not user:\n        return jsonify({'in_cart': False})\n\n    item = Cart.query.filter_by(user_id=user['user_id'], product_id=product_id).first()\n\n    if item:\n        return jsonify({'in_cart': True, 'quantity': item.quantity})\n    else:\n        return jsonify({'in_cart': False})\n\n@app.route('/cart/update', methods=['POST'])\ndef update_cart():\n    user = get_current_user()\n\n    if not user:\n        return jsonify({'success': False, 'message': 'Unauthorized'}), 401\n\n    data = request.json\n    product_id = data.get('product_id')\n    quantity = data.get('quantity', 1)\n\n    if quantity < 1:\n        return jsonify({'success': False, 'message': 'Quantity must be at least 1'})\n\n    cart_item = Cart.query.filter_by(user_id=user['user_id'], product_id=product_id).first()\n    \n    if cart_item:\n        cart_item.quantity = quantity\n        db.session.commit()\n        return jsonify({'success': True, 'message': 'Cart updated!', 'quantity': quantity})\n    else:\n        return jsonify({'success': False, 'message': 'Item not in cart'})\n\n@app.route('/cart/remove/<int:cart_id>', methods=['POST'])\ndef remove_from_cart(cart_id):\n    user = get_current_user()\n\n    if not user:\n        return jsonify({'success': False, 'message': 'Unauthorized'}), 401\n\n    cart_item = Cart.query.filter_by(id=cart_id, user_id=user['user_id']).first()\n    if cart_item:\n        db.session.delete(cart_item)\n        db.session.commit()\n\n    return jsonify({'success': True, 'message': 'Removed from cart'})\n\n@app.route('/cart/remove-by-product/<product_id>', methods=['POST'])\ndef remove_by_product(product_id):\n    user = get_current_user()\n\n    if not user:\n        return jsonify({'success': False, 'message': 'Unauthorized'}), 401\n\n    cart_item = Cart.query.filter_by(user_id=user['user_id'], product_id=product_id).first()\n    if cart_item:\n        db.session.delete(cart_item)\n        db.session.commit()\n        return jsonify({'success': True, 'message': 'Removed from cart'})\n    \n    return jsonify({'success': False, 'message': 'Item not found'})\n\n@app.route('/checkout', methods=['GET', 'POST'])\ndef checkout():\n    user = get_current_user()\n\n    if not user:\n        return redirect(url_for('login'))\n\n    if request.method == 'POST':\n        data = request.json\n        delivery_address = data.get('address')\n        delivery_lat = data.get('latitude')\n        delivery_lng = data.get('longitude')\n\n        cart_items = db.session.query(Cart, Product).join(Product, Cart.product_id == Product.product_id).filter(Cart.user_id == user['user_id']).all()\n\n        if not cart_items:\n            return jsonify({'success': False, 'message': 'Cart is empty'})\n\n        total_amount = sum(product.price * cart_item.quantity for cart_item, product in cart_items)\n        order_id = f\"ORD_{datetime.utcnow().strftime('%Y%m%d%H%M%S')}_{secrets.token_hex(4)}\"\n\n        products_json = json.dumps([{\n            'product_id': cart_item.product_id,\n            'name': product.name,\n            'quantity': cart_item.quantity,\n            'price': product.price\n        } for cart_item, product in cart_items])\n\n        new_order = Order(\n            order_id=order_id,\n            user_id=user['user_id'],\n            products=products_json,\n            total_amount=total_amount,\n            delivery_address=delivery_address,\n            delivery_lat=delivery_lat,\n            delivery_lng=delivery_lng\n        )\n        db.session.add(new_order)\n        \n        Cart.query.filter_by(user_id=user['user_id']).delete()\n        \n        db.session.commit()\n\n        return jsonify({'success': True, 'message': 'Order placed successfully!', 'order_id': order_id})\n\n    return render_template('checkout.html', user=user)\n\n@app.route('/orders')\ndef orders():\n    user = get_current_user()\n\n    if not user:\n        return redirect(url_for('login'))\n\n    orders_list = Order.query.filter_by(user_id=user['user_id']).order_by(Order.created_at.desc()).all()\n\n    orders_data = []\n    for order in orders_list:\n        order_dict = {\n            'order_id': order.order_id,\n            'products': json.loads(order.products),\n            'total_amount': order.total_amount,\n            'delivery_address': order.delivery_address,\n            'status': order.status,\n            'created_at': order.created_at\n        }\n        orders_data.append(order_dict)\n\n    return render_template('orders.html', orders=orders_data, user=user)\n\n@app.route('/api/categories')\ndef get_categories():\n    categories = db.session.query(Product.category).filter(Product.category.isnot(None)).distinct().all()\n    categories_list = [cat[0] for cat in categories]\n    return jsonify(categories_list)\n\n@app.route('/api/nearby-shops')\ndef nearby_shops():\n    user_lat = request.args.get('lat', type=float)\n    user_lng = request.args.get('lng', type=float)\n    \n    if user_lat is None or user_lng is None:\n        return jsonify([])\n    \n    sellers = User.query.filter(User.shop_latitude.isnot(None), User.shop_longitude.isnot(None)).all()\n    nearby_shops = []\n    \n    for seller in sellers:\n        if seller.shop_latitude == 0.0 and seller.shop_longitude == 0.0:\n            continue\n        distance = calculate_distance(user_lat, user_lng, seller.shop_latitude, seller.shop_longitude)\n        if distance <= 30:\n            shop_dict = {\n                'shop_name': seller.shop_name,\n                'shop_address': seller.shop_address,\n                'latitude': seller.shop_latitude,\n                'longitude': seller.shop_longitude,\n                'city': seller.shop_city,\n                'distance': round(distance, 1)\n            }\n            nearby_shops.append(shop_dict)\n    \n    nearby_shops.sort(key=lambda x: x['distance'])\n    return jsonify(nearby_shops)\n\n@app.route('/api/firebase-config')\ndef firebase_config():\n    firebase_api_key = os.environ.get('FIREBASE_API_KEY')\n\n    if not firebase_api_key:\n        return jsonify({'enabled': False})\n\n    return jsonify({\n        'enabled': True,\n        'firebaseConfig': {\n            'apiKey': firebase_api_key,\n            'authDomain': os.environ.get('FIREBASE_AUTH_DOMAIN', ''),\n            'projectId': os.environ.get('FIREBASE_PROJECT_ID', ''),\n            'storageBucket': os.environ.get('FIREBASE_STORAGE_BUCKET', ''),\n            'messagingSenderId': os.environ.get('FIREBASE_MESSAGING_SENDER_ID', ''),\n            'appId': os.environ.get('FIREBASE_APP_ID', '')\n        },\n        'vapidKey': os.environ.get('FIREBASE_VAPID_KEY', '')\n    })\n\n@app.route('/api/save-fcm-token', methods=['POST'])\ndef save_fcm_token():\n    user = get_current_user()\n\n    if not user:\n        return jsonify({'success': False, 'message': 'Not authenticated'}), 401\n\n    data = request.json\n    fcm_token = data.get('token')\n\n    if fcm_token:\n        seller = User.query.filter_by(user_id=user['user_id']).first()\n        if seller:\n            seller.fcm_token = fcm_token\n            db.session.commit()\n        \n        return jsonify({'success': True, 'message': 'FCM token saved'})\n\n    return jsonify({'success': False, 'message': 'No token provided'})\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000, debug=True)\n","size_bytes":32340},"FlipkartClone/models.py":{"content":"from flask_sqlalchemy import SQLAlchemy\nfrom datetime import datetime\nfrom sqlalchemy import Text, Integer, Float, Boolean, String\n\ndb = SQLAlchemy()\n\nclass TempUser(db.Model):\n    __tablename__ = 'temp_users'\n    \n    id = db.Column(Integer, primary_key=True)\n    user_id = db.Column(String(100), unique=True, nullable=False)\n    email = db.Column(String(120), unique=True, nullable=False)\n    password_hash = db.Column(String(200), nullable=False)\n    full_name = db.Column(String(100), nullable=False)\n    phone = db.Column(String(20))\n    user_type = db.Column(String(20), default='buyer')\n    created_at = db.Column(db.DateTime, default=datetime.utcnow)\n    expires_at = db.Column(db.DateTime, nullable=False)\n\nclass User(db.Model):\n    __tablename__ = 'users'\n    \n    id = db.Column(Integer, primary_key=True)\n    user_id = db.Column(String(100), unique=True, nullable=False)\n    email = db.Column(String(120), unique=True, nullable=False)\n    password_hash = db.Column(String(200), nullable=False)\n    full_name = db.Column(String(100), nullable=False)\n    phone = db.Column(String(20))\n    user_type = db.Column(String(20), default='buyer')\n    login_status = db.Column(Integer, default=0)\n    created_at = db.Column(db.DateTime, default=datetime.utcnow)\n    \n    shop_name = db.Column(String(200))\n    shop_address = db.Column(Text)\n    shop_latitude = db.Column(Float)\n    shop_longitude = db.Column(Float)\n    shop_city = db.Column(String(100))\n    shop_pincode = db.Column(String(10))\n    \n    fcm_token = db.Column(String(255))\n    \n    auth_tokens = db.relationship('AuthToken', backref='user', lazy=True, cascade='all, delete-orphan')\n    products = db.relationship('Product', backref='seller', lazy=True, cascade='all, delete-orphan')\n    cart_items = db.relationship('Cart', backref='user', lazy=True, cascade='all, delete-orphan')\n    orders = db.relationship('Order', foreign_keys='Order.user_id', backref='user', lazy=True, cascade='all, delete-orphan')\n    seller_orders = db.relationship('Order', foreign_keys='Order.seller_id', backref='seller', lazy=True)\n    addresses = db.relationship('Address', backref='user', lazy=True, cascade='all, delete-orphan')\n    logout_tokens = db.relationship('LogoutToken', backref='user', lazy=True, cascade='all, delete-orphan')\n\nclass AuthToken(db.Model):\n    __tablename__ = 'auth_tokens'\n    \n    id = db.Column(Integer, primary_key=True)\n    user_id = db.Column(String(100), db.ForeignKey('users.user_id'), nullable=False)\n    token = db.Column(String(200), unique=True, nullable=False)\n    login_time = db.Column(db.DateTime, default=datetime.utcnow)\n    is_active = db.Column(Integer, default=1)\n\nclass Product(db.Model):\n    __tablename__ = 'products'\n    \n    id = db.Column(Integer, primary_key=True)\n    product_id = db.Column(String(100), unique=True, nullable=False)\n    seller_id = db.Column(String(100), db.ForeignKey('users.user_id'), nullable=False)\n    name = db.Column(String(200), nullable=False)\n    description = db.Column(Text)\n    category = db.Column(String(100))\n    price = db.Column(Float, nullable=False)\n    stock = db.Column(Integer, default=0)\n    online_stock = db.Column(Integer, default=0)\n    images = db.Column(Text)\n    is_visible = db.Column(Integer, default=1)\n    expiry_date = db.Column(String(50))\n    rating = db.Column(Float, default=0.0)\n    rating_count = db.Column(Integer, default=0)\n    created_at = db.Column(db.DateTime, default=datetime.utcnow)\n    \n    cart_items = db.relationship('Cart', backref='product', lazy=True, cascade='all, delete-orphan')\n    reviews = db.relationship('Review', backref='product', lazy=True, cascade='all, delete-orphan')\n\nclass Cart(db.Model):\n    __tablename__ = 'cart'\n    \n    id = db.Column(Integer, primary_key=True)\n    user_id = db.Column(String(100), db.ForeignKey('users.user_id'), nullable=False)\n    product_id = db.Column(String(100), db.ForeignKey('products.product_id'), nullable=False)\n    quantity = db.Column(Integer, default=1)\n    added_at = db.Column(db.DateTime, default=datetime.utcnow)\n\nclass Order(db.Model):\n    __tablename__ = 'orders'\n    \n    id = db.Column(Integer, primary_key=True)\n    order_id = db.Column(String(100), unique=True, nullable=False)\n    user_id = db.Column(String(100), db.ForeignKey('users.user_id'), nullable=False)\n    products = db.Column(Text, nullable=False)\n    total_amount = db.Column(Float, nullable=False)\n    delivery_address = db.Column(Text)\n    delivery_lat = db.Column(Float)\n    delivery_lng = db.Column(Float)\n    purchase_option = db.Column(String(50), default='delivery')\n    pickup_slot = db.Column(String(100))\n    seller_id = db.Column(String(100), db.ForeignKey('users.user_id'))\n    status = db.Column(String(50), default='pending')\n    created_at = db.Column(db.DateTime, default=datetime.utcnow)\n\nclass Address(db.Model):\n    __tablename__ = 'addresses'\n    \n    id = db.Column(Integer, primary_key=True)\n    user_id = db.Column(String(100), db.ForeignKey('users.user_id'), nullable=False)\n    address_line = db.Column(Text, nullable=False)\n    city = db.Column(String(100))\n    state = db.Column(String(100))\n    pincode = db.Column(String(10))\n    latitude = db.Column(Float)\n    longitude = db.Column(Float)\n    is_default = db.Column(Integer, default=0)\n\nclass LogoutToken(db.Model):\n    __tablename__ = 'logout_tokens'\n    \n    id = db.Column(Integer, primary_key=True)\n    user_id = db.Column(String(100), db.ForeignKey('users.user_id'), nullable=False)\n    token = db.Column(String(200), unique=True, nullable=False)\n    created_at = db.Column(db.DateTime, default=datetime.utcnow)\n    expires_at = db.Column(db.DateTime, nullable=False)\n    used = db.Column(Integer, default=0)\n\nclass Review(db.Model):\n    __tablename__ = 'reviews'\n    \n    id = db.Column(Integer, primary_key=True)\n    product_id = db.Column(String(100), db.ForeignKey('products.product_id'), nullable=False)\n    user_id = db.Column(String(100), db.ForeignKey('users.user_id'), nullable=False)\n    rating = db.Column(Integer, nullable=False)\n    comment = db.Column(Text)\n    created_at = db.Column(db.DateTime, default=datetime.utcnow)\n\nclass RoutePlan(db.Model):\n    __tablename__ = 'route_plans'\n    \n    id = db.Column(Integer, primary_key=True)\n    user_id = db.Column(String(100), db.ForeignKey('users.user_id'), nullable=False)\n    origin_lat = db.Column(Float, nullable=False)\n    origin_lng = db.Column(Float, nullable=False)\n    destination_lat = db.Column(Float)\n    destination_lng = db.Column(Float)\n    gemini_request = db.Column(Text)\n    gemini_response = db.Column(Text)\n    status = db.Column(String(50), default='active')\n    created_at = db.Column(db.DateTime, default=datetime.utcnow)\n    \n    stops = db.relationship('RoutePlanStop', backref='route', lazy=True, cascade='all, delete-orphan')\n\nclass RoutePlanStop(db.Model):\n    __tablename__ = 'route_plan_stops'\n    \n    id = db.Column(Integer, primary_key=True)\n    route_plan_id = db.Column(Integer, db.ForeignKey('route_plans.id'), nullable=False)\n    seller_id = db.Column(String(100), db.ForeignKey('users.user_id'), nullable=False)\n    product_id = db.Column(String(100), db.ForeignKey('products.product_id'), nullable=False)\n    stop_order = db.Column(Integer, nullable=False)\n    shop_lat = db.Column(Float, nullable=False)\n    shop_lng = db.Column(Float, nullable=False)\n    estimated_arrival = db.Column(String(50))\n","size_bytes":7392},"main.py":{"content":"def main():\n    print(\"Hello from repl-nix-workspace!\")\n\n\nif __name__ == \"__main__\":\n    main()\n","size_bytes":96},"FlipkartClone/main.py":{"content":"def main():\n    print(\"Hello from repl-nix-workspace!\")\n\n\nif __name__ == \"__main__\":\n    main()\n","size_bytes":96},"FlipkartClone/static/css/style.css":{"content":"* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\n@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&family=Inter:wght@300;400;500;600;700&display=swap');\n\n:root {\n    --primary-black: #1b1b1b;\n    --soft-black: #242424;\n    --gray-900: #111827;\n    --gray-800: #1F2937;\n    --gray-700: #374151;\n    --gray-600: #4B5563;\n    --gray-500: #6B7280;\n    --gray-400: #9CA3AF;\n    --gray-300: #D1D5DB;\n    --gray-200: #E5E7EB;\n    --gray-100: #F3F4F6;\n    --gray-50: #F9FAFB;\n    --white: #FFFFFF;\n    --off-white: #FAFAFA;\n    \n    --text-primary: rgba(27, 27, 27, 0.87);\n    --text-secondary: rgba(27, 27, 27, 0.60);\n    --text-disabled: rgba(27, 27, 27, 0.38);\n    --text-dark: #111827;\n    --text-light: #6B7280;\n    --bg-light: #F9FAFB;\n    --bg-white: #FFFFFF;\n    --bg-dark: #111827;\n    --border-color: #E5E7EB;\n    --border-dark: #374151;\n    \n    --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);\n    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);\n    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);\n    --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);\n    --shadow-inset: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06);\n}\n\nbody {\n    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n    color: var(--text-dark);\n    background-color: var(--bg-light);\n    line-height: 1.6;\n}\n\nh1, h2, h3, h4, h5, h6 {\n    font-family: 'Poppins', sans-serif;\n    font-weight: 600;\n}\n\n.navbar {\n    background: linear-gradient(135deg, var(--primary-black) 0%, var(--gray-900) 100%);\n    color: white;\n    padding: 0;\n    position: sticky;\n    top: 0;\n    z-index: 1000;\n    box-shadow: var(--shadow-lg);\n    border-bottom: 2px solid var(--gray-800);\n    backdrop-filter: blur(10px);\n}\n\n.nav-container {\n    max-width: 1400px;\n    margin: 0 auto;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 12px 20px;\n    gap: 20px;\n}\n\n.nav-logo a {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    color: white;\n    text-decoration: none;\n    font-size: 24px;\n    font-weight: bold;\n    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5), 0 0 10px rgba(110, 231, 183, 0.3);\n    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));\n}\n\n.nav-logo i {\n    font-size: 28px;\n}\n\n.nav-search {\n    flex: 1;\n    max-width: 600px;\n    display: flex;\n}\n\n.nav-search input {\n    flex: 1;\n    padding: 10px 15px;\n    border: 2px solid var(--gray-700);\n    outline: none;\n    font-size: 14px;\n    border-radius: 4px 0 0 4px;\n    background: var(--white);\n    box-shadow: var(--shadow-inset);\n    color: var(--text-dark);\n}\n\n.nav-search button {\n    padding: 10px 20px;\n    background: var(--white);\n    border: 2px solid var(--gray-700);\n    cursor: pointer;\n    border-radius: 0 4px 4px 0;\n    color: var(--text-dark);\n    box-shadow: var(--shadow-md);\n    font-weight: bold;\n    transition: all 0.3s;\n}\n\n.nav-search button:hover {\n    background: var(--gray-100);\n    transform: translateY(-2px);\n    box-shadow: var(--shadow-lg);\n}\n\n.nav-links {\n    display: flex;\n    gap: 25px;\n    align-items: center;\n}\n\n.nav-links a {\n    color: white;\n    text-decoration: none;\n    font-size: 14px;\n    display: flex;\n    align-items: center;\n    gap: 5px;\n    transition: all 0.3s;\n    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);\n}\n\n.nav-links a:hover {\n    color: var(--gray-300);\n    transform: translateY(-2px);\n    filter: drop-shadow(0 4px 8px rgba(255, 255, 255, 0.2));\n}\n\n.user-greeting {\n    font-size: 14px;\n    font-weight: 500;\n}\n\n.container {\n    max-width: 1400px;\n    margin: 0 auto;\n    padding: 20px;\n}\n\n.hero-section {\n    background: linear-gradient(135deg, var(--primary-black) 0%, var(--gray-800) 100%);\n    color: white;\n    padding: 80px 20px;\n    text-align: center;\n    margin-bottom: 30px;\n    box-shadow: var(--shadow-xl);\n    border: 1px solid var(--gray-700);\n    position: relative;\n    overflow: hidden;\n}\n\n.hero-content h1 {\n    font-size: 48px;\n    margin-bottom: 15px;\n    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);\n    letter-spacing: 2px;\n}\n\n.hero-content p {\n    font-size: 20px;\n    opacity: 0.87;\n    color: rgba(255, 255, 255, 0.87);\n}\n\n.categories-section {\n    background: white;\n    padding: 40px 0;\n    margin-bottom: 30px;\n}\n\n.categories-section h2 {\n    text-align: center;\n    margin-bottom: 30px;\n    font-size: 32px;\n}\n\n.categories-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n    gap: 20px;\n    padding: 0 20px;\n}\n\n.category-card {\n    background: var(--white);\n    padding: 30px;\n    text-align: center;\n    border-radius: 12px;\n    cursor: pointer;\n    transition: all 0.3s;\n    border: 2px solid var(--border-color);\n    box-shadow: var(--shadow-md);\n}\n\n.category-card:hover {\n    transform: translateY(-8px) scale(1.05);\n    box-shadow: var(--shadow-xl);\n    border-color: var(--gray-700);\n    background: var(--gray-50);\n}\n\n.category-card i {\n    font-size: 48px;\n    color: var(--gray-800);\n    margin-bottom: 10px;\n}\n\n.category-card p {\n    font-weight: 500;\n    color: var(--text-dark);\n}\n\n.products-section {\n    padding: 40px 0;\n}\n\n.products-section h2 {\n    margin-bottom: 30px;\n    font-size: 32px;\n}\n\n.products-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\n    gap: 20px;\n}\n\n.product-card {\n    background: var(--bg-white);\n    border-radius: 20px;\n    overflow: hidden;\n    cursor: pointer;\n    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n    box-shadow: var(--shadow-md);\n    border: 1px solid var(--border-color);\n    position: relative;\n    display: flex;\n    flex-direction: column;\n}\n\n.product-card:hover {\n    transform: translateY(-8px);\n    box-shadow: var(--shadow-xl);\n    border-color: var(--gray-700);\n}\n\n.product-image {\n    width: 100%;\n    height: 280px;\n    overflow: hidden;\n    background: var(--gray-50);\n    position: relative;\n}\n\n.product-image img {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n    transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.product-card:hover .product-image img {\n    transform: scale(1.05);\n}\n\n.product-info {\n    padding: 20px;\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n}\n\n.product-info h3 {\n    font-size: 17px;\n    font-weight: 600;\n    margin-bottom: 8px;\n    color: var(--text-dark);\n    font-family: 'Poppins', sans-serif;\n    line-height: 1.3;\n    display: -webkit-box;\n    -webkit-line-clamp: 2;\n    -webkit-box-orient: vertical;\n    overflow: hidden;\n}\n\n.product-description {\n    font-size: 13px;\n    color: var(--text-light);\n    margin-bottom: 12px;\n    line-height: 1.5;\n}\n\n.product-price {\n    font-size: 26px;\n    font-weight: 700;\n    color: var(--primary-black);\n    margin-bottom: 8px;\n    font-family: 'Poppins', sans-serif;\n}\n\n.product-category {\n    display: inline-block;\n    background: var(--gray-100);\n    padding: 6px 14px;\n    border-radius: 20px;\n    font-size: 12px;\n    font-weight: 500;\n    color: var(--primary-black);\n    border: 1px solid rgba(124, 58, 237, 0.2);\n    margin-top: auto;\n}\n\n.cart-actions {\n    width: 100%;\n}\n\n.add-to-cart-btn {\n    width: 100%;\n    padding: 14px;\n    background: linear-gradient(135deg, var(--primary-black) 0%, var(--gray-900) 100%);\n    color: white;\n    border: none;\n    border-radius: 12px;\n    cursor: pointer;\n    font-size: 15px;\n    font-weight: 600;\n    font-family: 'Poppins', sans-serif;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);\n}\n\n.add-to-cart-btn:hover {\n    background: linear-gradient(135deg, var(--gray-900) 0%, var(--primary-black) 100%);\n    transform: translateY(-2px);\n    box-shadow: 0 6px 20px rgba(124, 58, 237, 0.4);\n}\n\n.add-to-cart-btn:active {\n    transform: translateY(0);\n}\n\n.cart-quantity-control {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    gap: 12px;\n    width: 100%;\n    padding: 10px 12px;\n    background: linear-gradient(135deg, rgba(0, 230, 179, 0.1) 0%, rgba(124, 58, 237, 0.1) 100%);\n    border-radius: 12px;\n    border: 2px solid var(--gray-600);\n}\n\n.cart-qty-btn {\n    width: 36px;\n    height: 36px;\n    border-radius: 10px;\n    border: none;\n    background: var(--primary-black);\n    color: white;\n    font-size: 18px;\n    font-weight: bold;\n    cursor: pointer;\n    transition: all 0.2s;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.cart-qty-btn:hover {\n    background: var(--gray-900);\n    transform: scale(1.05);\n}\n\n.cart-qty-btn:active {\n    transform: scale(0.95);\n}\n\n.cart-qty-display {\n    flex: 1;\n    text-align: center;\n    font-size: 16px;\n    font-weight: 600;\n    color: var(--text-dark);\n    font-family: 'Poppins', sans-serif;\n}\n\n.no-products {\n    text-align: center;\n    padding: 60px 20px;\n    background: white;\n    border-radius: 8px;\n}\n\n.no-products i {\n    font-size: 64px;\n    color: var(--text-light);\n    margin-bottom: 20px;\n}\n\n.no-products p {\n    font-size: 18px;\n    color: var(--text-light);\n    margin-bottom: 20px;\n}\n\n.auth-container {\n    min-height: 80vh;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    padding: 20px;\n}\n\n.auth-card {\n    background: linear-gradient(135deg, var(--bg-light) 0%, rgba(212, 197, 176, 0.5) 100%);\n    padding: 40px;\n    border-radius: 12px;\n    box-shadow: var(--shadow-xl);\n    border: 3px solid var(--border-color);\n    width: 100%;\n    max-width: 450px;\n}\n\n.auth-card h2 {\n    margin-bottom: 30px;\n    text-align: center;\n    color: var(--primary-black);\n}\n\n.form-group {\n    margin-bottom: 20px;\n}\n\n.form-group label {\n    display: block;\n    margin-bottom: 8px;\n    font-weight: 500;\n    color: var(--text-dark);\n}\n\n.form-group input,\n.form-group select,\n.form-group textarea {\n    width: 100%;\n    padding: 12px;\n    border: 2px solid var(--border-color);\n    border-radius: 6px;\n    font-size: 14px;\n    outline: none;\n    transition: all 0.3s;\n    background: var(--bg-light);\n    box-shadow: var(--shadow-inset);\n}\n\n.form-group input:focus,\n.form-group select:focus,\n.form-group textarea:focus {\n    border-color: var(--gray-700);\n    box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1), var(--shadow-inset);\n}\n\n.form-row {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n    gap: 15px;\n}\n\n.btn-primary {\n    padding: 12px 30px;\n    background: var(--primary-black);\n    color: var(--white);\n    border: 2px solid var(--primary-black);\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 16px;\n    font-weight: 500;\n    transition: all 0.3s;\n    text-decoration: none;\n    display: inline-block;\n    box-shadow: var(--shadow-md);\n}\n\n.btn-primary:hover {\n    background: var(--gray-800);\n    border-color: var(--gray-800);\n    transform: translateY(-3px);\n    box-shadow: var(--shadow-lg);\n}\n\n.btn-large {\n    padding: 15px 40px;\n    font-size: 18px;\n}\n\n.btn-block {\n    width: 100%;\n    display: block;\n    text-align: center;\n}\n\n.auth-switch {\n    text-align: center;\n    margin-top: 20px;\n    color: var(--text-light);\n}\n\n.auth-switch a {\n    color: var(--primary-black);\n    text-decoration: none;\n    font-weight: 500;\n}\n\n.notification {\n    position: fixed;\n    top: 80px;\n    right: 20px;\n    padding: 15px 25px;\n    background: white;\n    border-radius: 8px;\n    box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n    transform: translateX(400px);\n    transition: transform 0.3s;\n    z-index: 2000;\n    max-width: 350px;\n}\n\n.notification.show {\n    transform: translateX(0);\n}\n\n.notification.success {\n    border-left: 4px solid var(--gray-700);\n}\n\n.notification.error {\n    border-left: 4px solid var(--primary-black);\n}\n\n.footer {\n    background: linear-gradient(135deg, var(--bg-dark) 0%, var(--gray-900) 100%);\n    color: var(--white);\n    padding: 40px 0 20px;\n    margin-top: 60px;\n    box-shadow: 0 -8px 16px rgba(0, 0, 0, 0.5);\n    border-top: 3px solid var(--gray-700);\n}\n\n.footer-container {\n    max-width: 1400px;\n    margin: 0 auto;\n    padding: 0 20px;\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 30px;\n}\n\n.footer-section h3 {\n    margin-bottom: 15px;\n    font-size: 16px;\n}\n\n.footer-section ul {\n    list-style: none;\n}\n\n.footer-section ul li {\n    margin-bottom: 10px;\n}\n\n.footer-section ul li a {\n    color: #ccc;\n    text-decoration: none;\n    font-size: 14px;\n    transition: color 0.3s;\n}\n\n.footer-section ul li a:hover {\n    color: white;\n}\n\n.social-links {\n    display: flex;\n    gap: 15px;\n}\n\n.social-links a {\n    color: white;\n    font-size: 24px;\n    transition: color 0.3s;\n}\n\n.social-links a:hover {\n    color: var(--primary-black);\n}\n\n.footer-bottom {\n    text-align: center;\n    padding: 20px;\n    margin-top: 30px;\n    border-top: 1px solid #333;\n    color: #ccc;\n}\n\n.product-detail {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 40px;\n    background: white;\n    padding: 30px;\n    border-radius: 8px;\n    margin: 20px 0;\n}\n\n.product-gallery {\n    position: sticky;\n    top: 100px;\n}\n\n.main-image {\n    width: 100%;\n    height: 500px;\n    background: var(--bg-light);\n    border-radius: 8px;\n    overflow: hidden;\n    margin-bottom: 15px;\n}\n\n.main-image img {\n    width: 100%;\n    height: 100%;\n    object-fit: contain;\n}\n\n.thumbnail-images {\n    display: flex;\n    gap: 10px;\n}\n\n.thumbnail {\n    width: 80px;\n    height: 80px;\n    object-fit: cover;\n    border-radius: 4px;\n    cursor: pointer;\n    border: 2px solid var(--border-color);\n    transition: border-color 0.3s;\n}\n\n.thumbnail:hover,\n.thumbnail.active {\n    border-color: var(--primary-black);\n}\n\n.product-details h1 {\n    font-size: 28px;\n    margin-bottom: 15px;\n}\n\n.product-category-tag {\n    display: inline-block;\n    background: var(--bg-light);\n    padding: 6px 12px;\n    border-radius: 4px;\n    font-size: 14px;\n    color: var(--text-light);\n    margin-bottom: 15px;\n}\n\n.product-price-big {\n    font-size: 36px;\n    font-weight: bold;\n    color: var(--text-dark);\n    margin-bottom: 15px;\n}\n\n.product-stock {\n    margin-bottom: 20px;\n}\n\n.in-stock {\n    color: var(--success);\n    font-weight: 500;\n}\n\n.out-of-stock {\n    color: var(--error);\n    font-weight: 500;\n}\n\n.product-description-full {\n    padding: 20px 0;\n    border-top: 1px solid var(--border-color);\n    border-bottom: 1px solid var(--border-color);\n    margin-bottom: 20px;\n}\n\n.product-description-full h3 {\n    margin-bottom: 10px;\n}\n\n.product-actions {\n    margin-top: 30px;\n}\n\n.quantity-selector {\n    margin-bottom: 20px;\n}\n\n.quantity-selector label {\n    display: block;\n    margin-bottom: 8px;\n    font-weight: 500;\n}\n\n.quantity-selector input {\n    width: 100px;\n    padding: 10px;\n    border: 1px solid var(--border-color);\n    border-radius: 4px;\n    font-size: 16px;\n}\n\n.dashboard-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 30px;\n}\n\n.dashboard-stats {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 20px;\n    margin-bottom: 40px;\n}\n\n.stat-card {\n    background: white;\n    padding: 30px;\n    border-radius: 8px;\n    text-align: center;\n    box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n}\n\n.stat-card i {\n    font-size: 48px;\n    color: var(--primary-black);\n    margin-bottom: 15px;\n}\n\n.stat-card h3 {\n    font-size: 36px;\n    margin-bottom: 10px;\n}\n\n.stat-card p {\n    color: var(--text-light);\n}\n\n.form-container {\n    background: white;\n    padding: 40px;\n    border-radius: 8px;\n    max-width: 800px;\n    margin: 0 auto;\n}\n\n.image-preview {\n    display: flex;\n    gap: 10px;\n    flex-wrap: wrap;\n    margin-top: 15px;\n}\n\n.image-preview img {\n    width: 100px;\n    height: 100px;\n    object-fit: cover;\n    border-radius: 4px;\n    border: 2px solid var(--border-color);\n}\n\n.cart-container {\n    display: grid;\n    grid-template-columns: 2fr 1fr;\n    gap: 30px;\n    margin-top: 20px;\n}\n\n.cart-items {\n    background: white;\n    padding: 20px;\n    border-radius: 8px;\n}\n\n.cart-item {\n    display: flex;\n    gap: 20px;\n    padding: 20px;\n    border-bottom: 1px solid var(--border-color);\n    position: relative;\n}\n\n.cart-item:last-child {\n    border-bottom: none;\n}\n\n.cart-item-image {\n    width: 100px;\n    height: 100px;\n    flex-shrink: 0;\n}\n\n.cart-item-image img {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n    border-radius: 4px;\n}\n\n.cart-item-details {\n    flex: 1;\n}\n\n.cart-item-details h3 {\n    margin-bottom: 10px;\n}\n\n.cart-item-price {\n    font-size: 20px;\n    font-weight: bold;\n    margin-bottom: 5px;\n}\n\n.cart-item-quantity {\n    color: var(--text-light);\n}\n\n.cart-item-total {\n    font-size: 24px;\n    font-weight: bold;\n    align-self: center;\n}\n\n.cart-item-remove {\n    position: absolute;\n    top: 20px;\n    right: 20px;\n    background: none;\n    border: none;\n    color: var(--error);\n    font-size: 20px;\n    cursor: pointer;\n    transition: opacity 0.3s;\n}\n\n.cart-item-remove:hover {\n    opacity: 0.7;\n}\n\n.cart-summary {\n    background: white;\n    padding: 30px;\n    border-radius: 8px;\n    height: fit-content;\n    position: sticky;\n    top: 100px;\n}\n\n.cart-summary h2 {\n    margin-bottom: 20px;\n}\n\n.summary-row {\n    display: flex;\n    justify-content: space-between;\n    padding: 15px 0;\n    border-bottom: 1px solid var(--border-color);\n}\n\n.summary-total {\n    display: flex;\n    justify-content: space-between;\n    padding: 20px 0;\n    font-size: 20px;\n    font-weight: bold;\n}\n\n.empty-cart {\n    text-align: center;\n    padding: 80px 20px;\n    background: white;\n    border-radius: 8px;\n    margin-top: 20px;\n}\n\n.empty-cart i {\n    font-size: 80px;\n    color: var(--text-light);\n    margin-bottom: 20px;\n}\n\n.map-container {\n    width: 100%;\n    height: 400px;\n    border-radius: 8px;\n    margin: 20px 0;\n    border: 1px solid var(--border-color);\n}\n\n.checkout-container {\n    max-width: 800px;\n    margin: 20px auto;\n}\n\n.checkout-form {\n    background: white;\n    padding: 30px;\n    border-radius: 8px;\n}\n\n.orders-list {\n    margin-top: 20px;\n}\n\n.order-card {\n    background: white;\n    padding: 25px;\n    border-radius: 8px;\n    margin-bottom: 20px;\n    box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n}\n\n.order-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 20px;\n    padding-bottom: 15px;\n    border-bottom: 1px solid var(--border-color);\n}\n\n.order-header h3 {\n    margin-bottom: 5px;\n}\n\n.order-date {\n    color: var(--text-light);\n    font-size: 14px;\n}\n\n.order-status {\n    padding: 8px 16px;\n    border-radius: 4px;\n    font-weight: 500;\n    font-size: 14px;\n}\n\n.status-pending {\n    background-color: #fff3cd;\n    color: #856404;\n}\n\n.status-completed {\n    background-color: #d4edda;\n    color: #155724;\n}\n\n.order-items {\n    margin-bottom: 15px;\n}\n\n.order-item {\n    display: flex;\n    justify-content: space-between;\n    padding: 10px 0;\n    border-bottom: 1px solid var(--bg-light);\n}\n\n.order-footer {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-top: 15px;\n}\n\n.order-address {\n    color: var(--text-light);\n    font-size: 14px;\n}\n\n.order-total {\n    font-size: 18px;\n}\n\n.no-orders {\n    text-align: center;\n    padding: 80px 20px;\n    background: white;\n    border-radius: 8px;\n    margin-top: 20px;\n}\n\n.no-orders i {\n    font-size: 80px;\n    color: var(--text-light);\n    margin-bottom: 20px;\n}\n\n.verification-container {\n    min-height: 80vh;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.verification-card {\n    background: white;\n    padding: 60px;\n    border-radius: 8px;\n    text-align: center;\n    box-shadow: 0 4px 16px rgba(0,0,0,0.1);\n    max-width: 500px;\n}\n\n.success-icon,\n.error-icon {\n    font-size: 80px;\n    margin-bottom: 20px;\n}\n\n.success-icon i {\n    color: var(--success);\n}\n\n.error-icon i {\n    color: var(--error);\n}\n\n.verification-card h2 {\n    margin-bottom: 15px;\n}\n\n.verification-card p {\n    color: var(--text-light);\n    margin-bottom: 30px;\n}\n\n@media (max-width: 968px) {\n    .nav-container {\n        flex-wrap: wrap;\n    }\n    \n    .nav-search {\n        order: 3;\n        width: 100%;\n        max-width: 100%;\n        margin-top: 10px;\n    }\n    \n    .nav-links {\n        font-size: 12px;\n        gap: 15px;\n    }\n    \n    .hero-content h1 {\n        font-size: 32px;\n    }\n    \n    .product-detail {\n        grid-template-columns: 1fr;\n    }\n    \n    .cart-container {\n        grid-template-columns: 1fr;\n    }\n    \n    .products-grid {\n        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n    }\n}\n\n@media (max-width: 600px) {\n    .categories-grid {\n        grid-template-columns: repeat(3, 1fr);\n    }\n    \n    .products-grid {\n        grid-template-columns: repeat(2, 1fr);\n        gap: 10px;\n    }\n    \n    .product-image {\n        height: 180px;\n    }\n}\n\n/* Gen-Z Modern Styling & Animations */\n\n@keyframes fadeInUp {\n    from {\n        opacity: 0;\n        transform: translateY(30px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n@keyframes pulse {\n    0%, 100% {\n        transform: scale(1);\n    }\n    50% {\n        transform: scale(1.05);\n    }\n}\n\n@keyframes slideInRight {\n    from {\n        opacity: 0;\n        transform: translateX(-50px);\n    }\n    to {\n        opacity: 1;\n        transform: translateX(0);\n    }\n}\n\n.animated-title {\n    animation: fadeInUp 0.8s ease-out;\n    font-size: 3rem;\n    font-weight: 800;\n    background: linear-gradient(120deg, #fff 0%, var(--gray-200) 100%);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n}\n\n.animated-subtitle {\n    animation: fadeInUp 1s ease-out;\n    animation-delay: 0.2s;\n    opacity: 0;\n    animation-fill-mode: forwards;\n}\n\n/* Mode Toggle */\n.mode-toggle-container {\n    max-width: 1400px;\n    margin: 20px auto;\n    padding: 0 20px;\n    text-align: center;\n}\n\n.mode-toggle {\n    display: inline-flex;\n    align-items: center;\n    gap: 15px;\n    background: linear-gradient(135deg, var(--gray-900) 0%, var(--gray-800) 100%);\n    padding: 8px 15px;\n    border-radius: 50px;\n    box-shadow: var(--shadow-lg);\n    animation: slideInRight 0.6s ease-out;\n    border: 2px solid var(--gray-700);\n}\n\n.toggle-option {\n    background: transparent;\n    border: none;\n    color: white;\n    font-size: 14px;\n    font-weight: 600;\n    padding: 10px 20px;\n    cursor: pointer;\n    border-radius: 25px;\n    transition: all 0.3s;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n\n.toggle-option.active {\n    background: linear-gradient(135deg, var(--white) 0%, var(--gray-200) 100%);\n    color: var(--text-dark);\n    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);\n    box-shadow: var(--shadow-md);\n}\n\n.toggle-option:hover {\n    transform: scale(1.05);\n}\n\n.toggle-switch {\n    width: 50px;\n    height: 26px;\n    background: rgba(255, 255, 255, 0.2);\n    border-radius: 20px;\n    position: relative;\n}\n\n.toggle-slider {\n    width: 22px;\n    height: 22px;\n    background: white;\n    border-radius: 50%;\n    position: absolute;\n    top: 2px;\n    left: 2px;\n    transition: transform 0.3s;\n}\n\n.toggle-slider.local {\n    transform: translateX(24px);\n}\n\n.mode-description {\n    margin-top: 10px;\n    color: var(--text-light);\n    font-size: 14px;\n    animation: fadeInUp 0.8s ease-out;\n}\n\n/* Local Layout */\n.local-layout {\n    display: grid;\n    grid-template-columns: 1fr 400px;\n    gap: 20px;\n    max-width: 1400px;\n    margin: 0 auto;\n    padding: 20px;\n}\n\n.main-container {\n    min-height: 60vh;\n}\n\n/* Mega Sale Banner */\n.mega-sale-banner {\n    background: linear-gradient(135deg, var(--secondary-color) 0%, var(--gray-800) 100%);\n    border-radius: 20px;\n    padding: 30px;\n    margin-bottom: 30px;\n    position: relative;\n    overflow: hidden;\n    animation: fadeInUp 0.8s ease-out;\n    box-shadow: var(--shadow-lg);\n    border: 2px solid var(--gray-700);\n}\n\n.mega-sale-banner::before {\n    content: '';\n    position: absolute;\n    top: -50%;\n    right: -50%;\n    width: 200%;\n    height: 200%;\n    background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);\n    animation: pulse 3s infinite;\n}\n\n.sale-content h2 {\n    font-size: 2.5rem;\n    color: white;\n    font-weight: 800;\n    margin-bottom: 5px;\n}\n\n.sale-content h3 {\n    font-size: 1.8rem;\n    color: #fff176;\n    font-weight: 700;\n    margin-bottom: 20px;\n}\n\n.product-showcase {\n    display: flex;\n    gap: 15px;\n    margin-top: 20px;\n}\n\n.product-showcase img {\n    width: 100px;\n    height: 100px;\n    object-fit: cover;\n    border-radius: 15px;\n    border: 3px solid white;\n    box-shadow: 0 5px 15px rgba(0,0,0,0.2);\n    transition: transform 0.3s;\n}\n\n.product-showcase img:hover {\n    transform: translateY(-5px) scale(1.05);\n}\n\n.buddyshop-mode {\n    position: absolute;\n    bottom: 20px;\n    right: 20px;\n    background: white;\n    color: #f5576c;\n    padding: 8px 15px;\n    border-radius: 20px;\n    font-weight: 600;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n/* Distance Badge */\n.distance-badge {\n    position: absolute;\n    top: 10px;\n    right: 10px;\n    background: linear-gradient(135deg, var(--gray-800) 0%, var(--gray-700) 100%);\n    color: white;\n    padding: 5px 12px;\n    border-radius: 20px;\n    font-size: 12px;\n    font-weight: 600;\n    box-shadow: 0 3px 10px rgba(0,0,0,0.2);\n}\n\n.shop-name {\n    color: var(--text-light);\n    font-size: 13px;\n    margin-top: 5px;\n    display: flex;\n    align-items: center;\n    gap: 5px;\n}\n\n.rating {\n    color: #ff9f00;\n    font-size: 14px;\n    margin: 5px 0;\n}\n\n/* Map Sidebar */\n.map-sidebar {\n    position: sticky;\n    top: 80px;\n    height: fit-content;\n}\n\n.map-widget {\n    background: white;\n    border-radius: 20px;\n    overflow: hidden;\n    box-shadow: 0 10px 40px rgba(0,0,0,0.1);\n    animation: fadeInUp 1s ease-out;\n}\n\n.map-header {\n    background: linear-gradient(135deg, var(--gray-800) 0%, var(--gray-700) 100%);\n    color: white;\n    padding: 20px;\n    display: flex;\n    align-items: center;\n    gap: 10px;\n}\n\n.map-header h3 {\n    font-size: 16px;\n    font-weight: 600;\n}\n\n.map-container {\n    width: 100%;\n    height: 300px;\n    background: #e0e0e0;\n}\n\n.nearby-shops-list {\n    padding: 20px;\n    max-height: 400px;\n    overflow-y: auto;\n}\n\n.nearby-shops-list h4 {\n    font-size: 16px;\n    font-weight: 600;\n    margin-bottom: 15px;\n    color: var(--text-dark);\n}\n\n.shop-item {\n    padding: 15px;\n    background: var(--bg-light);\n    border-radius: 12px;\n    margin-bottom: 10px;\n    transition: all 0.3s;\n}\n\n.shop-item:hover {\n    transform: translateX(5px);\n    box-shadow: 0 5px 15px rgba(0,0,0,0.1);\n}\n\n.shop-item .shop-name {\n    font-weight: 600;\n    color: var(--text-dark);\n    margin-bottom: 5px;\n}\n\n.shop-item .shop-distance {\n    color: var(--primary-black);\n    font-weight: 600;\n    font-size: 14px;\n    margin-bottom: 3px;\n}\n\n.shop-item .shop-address {\n    font-size: 12px;\n    color: var(--text-light);\n}\n\n.no-shops {\n    text-align: center;\n    color: var(--text-light);\n    padding: 20px;\n}\n\n/* Switch Mode Banner */\n.switch-mode-banner {\n    position: fixed;\n    bottom: 30px;\n    right: 30px;\n    background: linear-gradient(135deg, var(--primary-black) 0%, var(--gray-800) 100%);\n    color: white;\n    padding: 20px 30px;\n    border-radius: 50px;\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);\n    z-index: 999;\n    animation: pulse 2s infinite;\n}\n\n.banner-content {\n    display: flex;\n    align-items: center;\n    gap: 20px;\n}\n\n.banner-content p {\n    font-size: 16px;\n    font-weight: 600;\n    margin: 0;\n}\n\n.switch-btn {\n    background: white;\n    color: var(--gray-800);\n    border: none;\n    width: 40px;\n    height: 40px;\n    border-radius: 50%;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: transform 0.3s;\n}\n\n.switch-btn:hover {\n    transform: scale(1.1) rotate(10deg);\n}\n\n/* Shop Location Card */\n.shop-location-card {\n    background: white;\n    border-radius: 20px;\n    padding: 30px;\n    margin-bottom: 30px;\n    box-shadow: 0 5px 20px rgba(0,0,0,0.08);\n    animation: fadeInUp 0.6s ease-out;\n}\n\n.shop-location-card h2 {\n    color: var(--text-dark);\n    margin-bottom: 10px;\n    display: flex;\n    align-items: center;\n    gap: 10px;\n}\n\n.help-text {\n    color: var(--text-light);\n    font-size: 14px;\n    margin-bottom: 20px;\n}\n\n.shop-location-form {\n    margin-top: 20px;\n}\n\n.form-grid {\n    display: grid;\n    grid-template-columns: repeat(2, 1fr);\n    gap: 20px;\n    margin-bottom: 20px;\n}\n\n.form-group label {\n    display: block;\n    font-weight: 600;\n    margin-bottom: 8px;\n    color: var(--text-dark);\n    font-size: 14px;\n}\n\n.form-group input {\n    width: 100%;\n    padding: 12px;\n    border: 2px solid var(--border-color);\n    border-radius: 10px;\n    font-size: 14px;\n    transition: all 0.3s;\n}\n\n.form-group input:focus {\n    outline: none;\n    border-color: var(--primary-black);\n    box-shadow: 0 0 0 3px rgba(40, 116, 240, 0.1);\n}\n\n.form-actions {\n    display: flex;\n    gap: 15px;\n    justify-content: flex-end;\n}\n\n.btn-secondary {\n    background: linear-gradient(135deg, var(--bg-light) 0%, var(--gray-200) 100%);\n    color: var(--text-dark);\n    border: 2px solid var(--border-color);\n    padding: 12px 25px;\n    border-radius: 10px;\n    font-weight: 600;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    transition: all 0.3s;\n    box-shadow: var(--shadow-sm);\n}\n\n.btn-secondary:hover {\n    background: linear-gradient(135deg, var(--gray-200) 0%, var(--bg-light) 100%);\n    transform: translateY(-2px);\n    box-shadow: var(--shadow-md);\n}\n\n/* Enhanced Product Cards */\n.product-card {\n    transition: all 0.3s ease;\n    animation: fadeInUp 0.6s ease-out;\n}\n\n.product-card:hover {\n    transform: translateY(-10px);\n    box-shadow: 0 15px 40px rgba(0,0,0,0.15);\n}\n\n.add-to-cart-btn {\n    transition: all 0.3s;\n}\n\n.add-to-cart-btn:hover {\n    transform: scale(1.05);\n    box-shadow: 0 5px 20px rgba(40, 116, 240, 0.3);\n}\n\n/* Responsive */\n@media (max-width: 1200px) {\n    .local-layout {\n        grid-template-columns: 1fr;\n    }\n    \n    .map-sidebar {\n        position: relative;\n        top: 0;\n    }\n    \n    .switch-mode-banner {\n        bottom: 20px;\n        right: 20px;\n        padding: 15px 20px;\n    }\n    \n    .banner-content p {\n        font-size: 14px;\n    }\n}\n\n@media (max-width: 768px) {\n    .mode-toggle {\n        flex-wrap: wrap;\n        justify-content: center;\n    }\n    \n    .form-grid {\n        grid-template-columns: 1fr;\n    }\n    \n    .mega-sale-banner {\n        padding: 20px;\n    }\n    \n    .sale-content h2 {\n        font-size: 1.8rem;\n    }\n    \n    .sale-content h3 {\n        font-size: 1.3rem;\n    }\n    \n    .product-showcase {\n        flex-wrap: wrap;\n    }\n    \n    .product-showcase img {\n        width: 80px;\n        height: 80px;\n    }\n}\n\n/* 3D Utility Classes - Cold War Professional Theme */\n\n.elevated {\n    box-shadow: var(--shadow-lg);\n    transform: translateZ(20px);\n    transition: all 0.3s ease;\n}\n\n.elevated:hover {\n    box-shadow: var(--shadow-xl);\n    transform: translateZ(30px) translateY(-5px);\n}\n\n.inset {\n    box-shadow: var(--shadow-inset);\n    background: linear-gradient(145deg, rgba(232, 228, 220, 0.8), rgba(212, 197, 176, 0.9));\n}\n\n.glossy {\n    background: linear-gradient(135deg, \n        rgba(255, 255, 255, 0.4) 0%, \n        rgba(255, 255, 255, 0.1) 50%, \n        rgba(0, 0, 0, 0.1) 100%);\n    border: 2px solid rgba(212, 197, 176, 0.3);\n    box-shadow: var(--shadow-md);\n}\n\n.metallic {\n    background: linear-gradient(135deg, \n        var(--gray-200) 0%, \n        var(--gray-700) 50%, \n        var(--gray-200) 100%);\n    color: var(--white);\n    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);\n    box-shadow: var(--shadow-lg), \n        inset 0 1px 0 rgba(255, 255, 255, 0.3),\n        inset 0 -1px 0 rgba(0, 0, 0, 0.3);\n}\n\n.military-badge {\n    position: relative;\n    padding: 10px 20px;\n    background: radial-gradient(circle, var(--secondary-color) 0%, var(--gray-800) 100%);\n    color: var(--white);\n    font-weight: bold;\n    text-transform: uppercase;\n    letter-spacing: 1.5px;\n    border: 2px solid var(--gray-700);\n    box-shadow: var(--shadow-lg);\n    transform: perspective(500px) rotateX(5deg);\n}\n\n.depth-sm {\n    box-shadow: var(--shadow-sm);\n}\n\n.depth-md {\n    box-shadow: var(--shadow-md);\n}\n\n.depth-lg {\n    box-shadow: var(--shadow-lg);\n}\n\n.depth-xl {\n    box-shadow: var(--shadow-xl);\n}\n\n.raised-button {\n    background: linear-gradient(135deg, var(--gray-700) 0%, var(--primary-black) 100%);\n    color: var(--white);\n    border: 2px solid var(--gray-700);\n    padding: 12px 30px;\n    border-radius: 8px;\n    font-weight: bold;\n    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.6);\n    box-shadow: var(--shadow-md), \n        inset 0 2px 0 rgba(255, 255, 255, 0.2),\n        inset 0 -2px 0 rgba(0, 0, 0, 0.2);\n    transition: all 0.3s;\n    cursor: pointer;\n}\n\n.raised-button:hover {\n    transform: translateY(-3px);\n    box-shadow: var(--shadow-xl);\n    background: linear-gradient(135deg, var(--primary-black) 0%, var(--gray-700) 100%);\n}\n\n.raised-button:active {\n    transform: translateY(0px);\n    box-shadow: var(--shadow-sm);\n}\n\n.engraved-text {\n    text-shadow: \n        1px 1px 0 rgba(255, 255, 255, 0.3),\n        -1px -1px 0 rgba(0, 0, 0, 0.5);\n    color: var(--text-dark);\n}\n\n.embossed-card {\n    background: linear-gradient(135deg, var(--bg-light) 0%, rgba(212, 197, 176, 0.6) 100%);\n    border: 3px solid var(--border-color);\n    border-radius: 12px;\n    padding: 20px;\n    box-shadow: \n        0 8px 16px rgba(0, 0, 0, 0.4),\n        inset 0 2px 0 rgba(255, 255, 255, 0.2),\n        inset 0 -2px 0 rgba(0, 0, 0, 0.1);\n}\n\n.cold-war-border {\n    border: 3px solid var(--border-color);\n    border-image: linear-gradient(45deg, var(--gray-700), var(--gray-200), var(--gray-700)) 1;\n    box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.2);\n}\n","size_bytes":33958},"pyproject.toml":{"content":"[project]\nname = \"repl-nix-workspace\"\nversion = \"0.1.0\"\ndescription = \"Add your description here\"\nrequires-python = \">=3.11\"\ndependencies = [\n    \"apscheduler>=3.11.1\",\n    \"email-validator>=2.3.0\",\n    \"flask>=3.1.2\",\n    \"flask-mail>=0.10.0\",\n    \"flask-sqlalchemy>=3.1.1\",\n    \"google-genai>=1.49.0\",\n    \"gunicorn>=23.0.0\",\n    \"psycopg2-binary>=2.9.11\",\n    \"werkzeug>=3.1.3\",\n]\n","size_bytes":384},"FlipkartClone/services/nearby_search.py":{"content":"from models import User, Product\nfrom services.geolocation import haversine_distance\n\ndef find_nearby_sellers(product_name, user_lat, user_lng, max_distance_km=10, category=None):\n    \"\"\"\n    Find sellers with the product within specified distance\n    Returns list of (seller, product, distance) tuples\n    \"\"\"\n    query = Product.query.filter(Product.is_visible == 1)\n    \n    if product_name:\n        query = query.filter(Product.name.ilike(f'%{product_name}%'))\n    \n    if category:\n        query = query.filter(Product.category == category)\n    \n    products = query.all()\n    \n    results = []\n    for product in products:\n        seller = User.query.filter_by(user_id=product.seller_id).first()\n        if not seller or not seller.shop_latitude or not seller.shop_longitude:\n            continue\n        \n        distance = haversine_distance(\n            user_lat, user_lng,\n            seller.shop_latitude, seller.shop_longitude\n        )\n        \n        if distance <= max_distance_km:\n            results.append({\n                'seller': seller,\n                'product': product,\n                'distance_km': round(distance, 2)\n            })\n    \n    results.sort(key=lambda x: x['distance_km'])\n    return results\n\ndef filter_search_results(results, min_price=None, max_price=None, min_rating=None, \n                         in_stock_only=True, purchase_option=None):\n    \"\"\"Apply filters to search results\"\"\"\n    filtered = results\n    \n    if min_price is not None:\n        filtered = [r for r in filtered if r['product'].price >= min_price]\n    \n    if max_price is not None:\n        filtered = [r for r in filtered if r['product'].price <= max_price]\n    \n    if min_rating is not None:\n        filtered = [r for r in filtered if r['product'].rating >= min_rating]\n    \n    if in_stock_only:\n        if purchase_option == 'delivery':\n            filtered = [r for r in filtered if r['product'].online_stock > 0]\n        else:\n            filtered = [r for r in filtered if r['product'].stock > 0]\n    \n    return filtered\n","size_bytes":2047},"FlipkartClone/static/firebase-messaging-sw.js":{"content":"importScripts('https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js');\nimportScripts('https://www.gstatic.com/firebasejs/10.7.1/firebase-messaging-compat.js');\n\nfirebase.initializeApp({\n    apiKey: \"YOUR_FIREBASE_API_KEY\",\n    authDomain: \"YOUR_PROJECT.firebaseapp.com\",\n    projectId: \"YOUR_PROJECT_ID\",\n    storageBucket: \"YOUR_PROJECT.appspot.com\",\n    messagingSenderId: \"YOUR_SENDER_ID\",\n    appId: \"YOUR_APP_ID\"\n});\n\nconst messaging = firebase.messaging();\n\nmessaging.onBackgroundMessage((payload) => {\n    console.log('Received background message:', payload);\n    \n    const notificationTitle = payload.notification.title;\n    const notificationOptions = {\n        body: payload.notification.body,\n        icon: '/static/icon.png'\n    };\n    \n    self.registration.showNotification(notificationTitle, notificationOptions);\n});\n","size_bytes":846},"FlipkartClone/auth.py":{"content":"import secrets\nimport hashlib\nfrom datetime import datetime, timedelta\nfrom models import db, User, TempUser, AuthToken, LogoutToken\n\ndef generate_user_id(email):\n    timestamp = datetime.utcnow().strftime('%Y%m%d%H%M%S')\n    hash_obj = hashlib.md5(email.encode())\n    return f\"USER_{timestamp}_{hash_obj.hexdigest()[:8]}\"\n\ndef generate_auth_token(user_id, login_time):\n    random_part = secrets.token_urlsafe(32)\n    timestamp = login_time.strftime('%Y%m%d%H%M%S')\n    combined = f\"{user_id}_{timestamp}_{random_part}\"\n    return hashlib.sha256(combined.encode()).hexdigest()\n\ndef create_temp_user(email, password_hash, full_name, phone, user_type):\n    user_id = generate_user_id(email)\n    expires_at = datetime.utcnow() + timedelta(minutes=15)\n    \n    try:\n        temp_user = TempUser(\n            user_id=user_id,\n            email=email,\n            password_hash=password_hash,\n            full_name=full_name,\n            phone=phone,\n            user_type=user_type,\n            expires_at=expires_at\n        )\n        db.session.add(temp_user)\n        db.session.commit()\n        return user_id\n    except Exception as e:\n        db.session.rollback()\n        print(f\"Error creating temp user: {e}\")\n        return None\n\ndef verify_and_move_user(user_id):\n    try:\n        temp_user = TempUser.query.filter_by(user_id=user_id).filter(\n            TempUser.expires_at > datetime.utcnow()\n        ).first()\n        \n        if temp_user:\n            new_user = User(\n                user_id=temp_user.user_id,\n                email=temp_user.email,\n                password_hash=temp_user.password_hash,\n                full_name=temp_user.full_name,\n                phone=temp_user.phone,\n                user_type=temp_user.user_type\n            )\n            db.session.add(new_user)\n            db.session.delete(temp_user)\n            db.session.commit()\n            return True\n        \n        return False\n    except Exception as e:\n        db.session.rollback()\n        print(f\"Error verifying user: {e}\")\n        return False\n\ndef create_auth_token(user_id):\n    login_time = datetime.utcnow()\n    token = generate_auth_token(user_id, login_time)\n    \n    try:\n        auth_token = AuthToken(\n            user_id=user_id,\n            token=token,\n            login_time=login_time\n        )\n        db.session.add(auth_token)\n        \n        user = User.query.filter_by(user_id=user_id).first()\n        if user:\n            user.login_status = 1\n        \n        db.session.commit()\n        return token\n    except Exception as e:\n        db.session.rollback()\n        print(f\"Error creating auth token: {e}\")\n        return None\n\ndef verify_token(token):\n    try:\n        auth_token = AuthToken.query.filter_by(token=token, is_active=1).first()\n        return auth_token.user_id if auth_token else None\n    except Exception as e:\n        print(f\"Error verifying token: {e}\")\n        return None\n\ndef create_logout_token(user_id):\n    token = secrets.token_urlsafe(32)\n    expires_at = datetime.utcnow() + timedelta(minutes=15)\n    \n    try:\n        logout_token = LogoutToken(\n            user_id=user_id,\n            token=token,\n            expires_at=expires_at\n        )\n        db.session.add(logout_token)\n        db.session.commit()\n        return token\n    except Exception as e:\n        db.session.rollback()\n        print(f\"Error creating logout token: {e}\")\n        return None\n\ndef verify_logout_token(token):\n    try:\n        logout_token = LogoutToken.query.filter_by(token=token, used=0).filter(\n            LogoutToken.expires_at > datetime.utcnow()\n        ).first()\n        \n        if logout_token:\n            logout_token.used = 1\n            db.session.commit()\n            return logout_token.user_id\n        \n        return None\n    except Exception as e:\n        db.session.rollback()\n        print(f\"Error verifying logout token: {e}\")\n        return None\n\ndef logout_user(user_id):\n    try:\n        AuthToken.query.filter_by(user_id=user_id).update({'is_active': 0})\n        user = User.query.filter_by(user_id=user_id).first()\n        if user:\n            user.login_status = 0\n        db.session.commit()\n    except Exception as e:\n        db.session.rollback()\n        print(f\"Error logging out user: {e}\")\n","size_bytes":4259},"FlipkartClone/scripts/seed.py":{"content":"import sys\nimport os\nsys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))\n\nfrom app import app, db\nfrom models import User, Product, Review\nfrom werkzeug.security import generate_password_hash\nimport random\nimport secrets\nimport json\n\nCATEGORIES = [\n    'Groceries', 'Electronics', 'Fashion', 'Home & Kitchen', \n    'Beauty & Personal Care', 'Sports & Fitness', 'Books', 'Toys',\n    'Automotive', 'Health & Wellness', 'Office Supplies', 'Pet Supplies'\n]\n\nCITIES = [\n    {'name': 'Bareilly', 'lat': 28.3670, 'lng': 79.4304},\n    {'name': 'Mumbai', 'lat': 19.076, 'lng': 72.877},\n    {'name': 'Delhi', 'lat': 28.704, 'lng': 77.102},\n    {'name': 'Bangalore', 'lat': 12.972, 'lng': 77.594},\n    {'name': 'Pune', 'lat': 18.520, 'lng': 73.857},\n]\n\nPRODUCTS_CATALOG = [\n    {'cat': 'Groceries', 'name': 'Organic Bananas', 'price': 40, 'desc': 'Fresh organic bananas'},\n    {'cat': 'Groceries', 'name': 'Whole Wheat Bread', 'price': 45, 'desc': 'Freshly baked bread'},\n    {'cat': 'Groceries', 'name': 'Fresh Milk 1L', 'price': 60, 'desc': 'Farm fresh milk'},\n    {'cat': 'Groceries', 'name': 'Basmati Rice 5kg', 'price': 450, 'desc': 'Premium basmati rice'},\n    {'cat': 'Groceries', 'name': 'Organic Eggs 12pcs', 'price': 90, 'desc': 'Cage-free eggs'},\n    {'cat': 'Groceries', 'name': 'Mixed Vegetables', 'price': 80, 'desc': 'Fresh seasonal vegetables'},\n    {'cat': 'Groceries', 'name': 'Greek Yogurt', 'price': 75, 'desc': 'Creamy yogurt'},\n    {'cat': 'Groceries', 'name': 'Olive Oil 500ml', 'price': 350, 'desc': 'Extra virgin'},\n    {'cat': 'Groceries', 'name': 'Tomatoes 1kg', 'price': 30, 'desc': 'Fresh red tomatoes'},\n    {'cat': 'Groceries', 'name': 'Onions 1kg', 'price': 25, 'desc': 'Quality onions'},\n    {'cat': 'Groceries', 'name': 'Potatoes 1kg', 'price': 20, 'desc': 'Fresh potatoes'},\n    {'cat': 'Groceries', 'name': 'Green Chili', 'price': 40, 'desc': 'Spicy green chili'},\n    {'cat': 'Groceries', 'name': 'Ginger 250g', 'price': 60, 'desc': 'Fresh ginger'},\n    {'cat': 'Groceries', 'name': 'Garlic 250g', 'price': 50, 'desc': 'Quality garlic'},\n    {'cat': 'Groceries', 'name': 'Coriander Leaves', 'price': 15, 'desc': 'Fresh coriander'},\n    {'cat': 'Groceries', 'name': 'Mint Leaves', 'price': 10, 'desc': 'Fresh mint'},\n    {'cat': 'Groceries', 'name': 'Apples 1kg', 'price': 120, 'desc': 'Kashmiri apples'},\n    {'cat': 'Groceries', 'name': 'Oranges 1kg', 'price': 60, 'desc': 'Juicy oranges'},\n    {'cat': 'Groceries', 'name': 'Mangoes 1kg', 'price': 150, 'desc': 'Alphonso mangoes'},\n    {'cat': 'Groceries', 'name': 'Grapes 500g', 'price': 70, 'desc': 'Seedless grapes'},\n    {'cat': 'Electronics', 'name': 'Wireless Mouse', 'price': 599, 'desc': 'Ergonomic mouse'},\n    {'cat': 'Electronics', 'name': 'Bluetooth Headphones', 'price': 1499, 'desc': 'Noise cancellation'},\n    {'cat': 'Electronics', 'name': 'Phone Charger', 'price': 299, 'desc': 'Fast charging USB-C'},\n    {'cat': 'Electronics', 'name': 'Laptop Stand', 'price': 899, 'desc': 'Adjustable stand'},\n    {'cat': 'Electronics', 'name': 'USB Hub', 'price': 699, 'desc': '7-port USB 3.0'},\n    {'cat': 'Electronics', 'name': 'Webcam HD', 'price': 2499, 'desc': '1080p webcam'},\n    {'cat': 'Electronics', 'name': 'Keyboard Wireless', 'price': 1299, 'desc': 'Mechanical keyboard'},\n    {'cat': 'Electronics', 'name': 'LED Monitor 24inch', 'price': 8999, 'desc': 'Full HD display'},\n    {'cat': 'Electronics', 'name': 'Power Bank 10000mAh', 'price': 999, 'desc': 'Fast charging'},\n    {'cat': 'Electronics', 'name': 'USB Cable 3pack', 'price': 299, 'desc': 'Durable cables'},\n    {'cat': 'Electronics', 'name': 'Phone Stand', 'price': 199, 'desc': 'Adjustable holder'},\n    {'cat': 'Electronics', 'name': 'Earbuds TWS', 'price': 1999, 'desc': 'True wireless'},\n    {'cat': 'Electronics', 'name': 'Smart Watch', 'price': 2999, 'desc': 'Fitness tracker'},\n    {'cat': 'Electronics', 'name': 'Tablet 10inch', 'price': 12999, 'desc': 'Android tablet'},\n    {'cat': 'Fashion', 'name': 'Cotton T-Shirt', 'price': 399, 'desc': '100% cotton'},\n    {'cat': 'Fashion', 'name': 'Denim Jeans', 'price': 1299, 'desc': 'Classic fit'},\n    {'cat': 'Fashion', 'name': 'Running Shoes', 'price': 2499, 'desc': 'Lightweight'},\n    {'cat': 'Fashion', 'name': 'Leather Wallet', 'price': 799, 'desc': 'Genuine leather'},\n    {'cat': 'Fashion', 'name': 'Sunglasses', 'price': 599, 'desc': 'UV protection'},\n    {'cat': 'Fashion', 'name': 'Winter Jacket', 'price': 3499, 'desc': 'Warm jacket'},\n    {'cat': 'Fashion', 'name': 'Formal Shirt', 'price': 899, 'desc': 'Office wear'},\n    {'cat': 'Fashion', 'name': 'Sports Shoes', 'price': 1899, 'desc': 'Athletic shoes'},\n    {'cat': 'Fashion', 'name': 'Casual Sneakers', 'price': 1599, 'desc': 'Daily wear'},\n    {'cat': 'Fashion', 'name': 'Belt Leather', 'price': 499, 'desc': 'Formal belt'},\n    {'cat': 'Fashion', 'name': 'Cap Baseball', 'price': 299, 'desc': 'Sports cap'},\n    {'cat': 'Fashion', 'name': 'Socks Pack of 5', 'price': 249, 'desc': 'Cotton socks'},\n    {'cat': 'Home & Kitchen', 'name': 'Cookware Set', 'price': 2999, 'desc': '5-piece non-stick'},\n    {'cat': 'Home & Kitchen', 'name': 'Mixer Grinder', 'price': 3499, 'desc': '750W 3 jars'},\n    {'cat': 'Home & Kitchen', 'name': 'Bed Sheet Set', 'price': 1299, 'desc': 'Cotton bedsheet'},\n    {'cat': 'Home & Kitchen', 'name': 'Table Lamp', 'price': 699, 'desc': 'LED lamp'},\n    {'cat': 'Home & Kitchen', 'name': 'Wall Clock', 'price': 499, 'desc': 'Silent clock'},\n    {'cat': 'Home & Kitchen', 'name': 'Dinner Set 24pc', 'price': 1999, 'desc': 'Ceramic set'},\n    {'cat': 'Home & Kitchen', 'name': 'Pressure Cooker 5L', 'price': 1599, 'desc': 'Aluminum cooker'},\n    {'cat': 'Home & Kitchen', 'name': 'Water Purifier', 'price': 8999, 'desc': 'RO purifier'},\n    {'cat': 'Beauty & Personal Care', 'name': 'Face Wash', 'price': 249, 'desc': 'For all skin types'},\n    {'cat': 'Beauty & Personal Care', 'name': 'Shampoo 200ml', 'price': 299, 'desc': 'Anti-dandruff'},\n    {'cat': 'Beauty & Personal Care', 'name': 'Body Lotion', 'price': 349, 'desc': 'Moisturizing'},\n    {'cat': 'Beauty & Personal Care', 'name': 'Perfume EDT', 'price': 999, 'desc': 'Long-lasting'},\n    {'cat': 'Beauty & Personal Care', 'name': 'Hair Oil 200ml', 'price': 199, 'desc': 'Herbal oil'},\n    {'cat': 'Beauty & Personal Care', 'name': 'Face Cream', 'price': 399, 'desc': 'Day cream'},\n    {'cat': 'Beauty & Personal Care', 'name': 'Soap Pack of 3', 'price': 150, 'desc': 'Herbal soap'},\n    {'cat': 'Beauty & Personal Care', 'name': 'Toothpaste 200g', 'price': 120, 'desc': 'Dental care'},\n    {'cat': 'Sports & Fitness', 'name': 'Yoga Mat', 'price': 599, 'desc': 'Anti-slip mat'},\n    {'cat': 'Sports & Fitness', 'name': 'Dumbbells 5kg pair', 'price': 899, 'desc': 'Rubber-coated'},\n    {'cat': 'Sports & Fitness', 'name': 'Resistance Bands', 'price': 399, 'desc': 'Set of 3'},\n    {'cat': 'Sports & Fitness', 'name': 'Water Bottle 1L', 'price': 299, 'desc': 'Insulated'},\n    {'cat': 'Sports & Fitness', 'name': 'Skipping Rope', 'price': 199, 'desc': 'Adjustable'},\n    {'cat': 'Sports & Fitness', 'name': 'Gym Bag', 'price': 899, 'desc': 'Sports bag'},\n    {'cat': 'Sports & Fitness', 'name': 'Cricket Bat', 'price': 1999, 'desc': 'Willow bat'},\n    {'cat': 'Sports & Fitness', 'name': 'Badminton Racket', 'price': 1299, 'desc': 'Lightweight'},\n    {'cat': 'Books', 'name': 'Fiction Novel', 'price': 299, 'desc': 'Bestseller'},\n    {'cat': 'Books', 'name': 'Self Help Book', 'price': 349, 'desc': 'Motivational'},\n    {'cat': 'Books', 'name': 'Cookbook', 'price': 399, 'desc': 'Indian recipes'},\n    {'cat': 'Books', 'name': 'Kids Story Book', 'price': 199, 'desc': 'Illustrated'},\n    {'cat': 'Books', 'name': 'Dictionary', 'price': 449, 'desc': 'English-Hindi'},\n    {'cat': 'Books', 'name': 'Notebook Set', 'price': 249, 'desc': 'Pack of 5'},\n    {'cat': 'Toys', 'name': 'Building Blocks', 'price': 599, 'desc': '100 pieces'},\n    {'cat': 'Toys', 'name': 'Remote Car', 'price': 899, 'desc': 'RC car'},\n    {'cat': 'Toys', 'name': 'Puzzle Game', 'price': 399, 'desc': '1000 pieces'},\n    {'cat': 'Toys', 'name': 'Soft Teddy Bear', 'price': 499, 'desc': 'Plush toy'},\n    {'cat': 'Toys', 'name': 'Board Game', 'price': 699, 'desc': 'Family game'},\n    {'cat': 'Toys', 'name': 'Action Figure', 'price': 799, 'desc': 'Superhero'},\n    {'cat': 'Automotive', 'name': 'Car Phone Holder', 'price': 299, 'desc': 'Dashboard mount'},\n    {'cat': 'Automotive', 'name': 'Car Vacuum Cleaner', 'price': 1299, 'desc': 'Portable'},\n    {'cat': 'Automotive', 'name': 'Tire Pressure Gauge', 'price': 199, 'desc': 'Digital'},\n    {'cat': 'Automotive', 'name': 'Car Perfume', 'price': 149, 'desc': 'Long-lasting'},\n    {'cat': 'Automotive', 'name': 'Jump Starter', 'price': 2999, 'desc': 'Emergency kit'},\n    {'cat': 'Health & Wellness', 'name': 'Vitamin C Tablets', 'price': 299, 'desc': '60 tablets'},\n    {'cat': 'Health & Wellness', 'name': 'Protein Powder', 'price': 1999, 'desc': '1kg pack'},\n    {'cat': 'Health & Wellness', 'name': 'First Aid Kit', 'price': 599, 'desc': 'Complete kit'},\n    {'cat': 'Health & Wellness', 'name': 'Digital Thermometer', 'price': 199, 'desc': 'Infrared'},\n    {'cat': 'Health & Wellness', 'name': 'Blood Pressure Monitor', 'price': 1499, 'desc': 'Digital'},\n    {'cat': 'Office Supplies', 'name': 'Pen Set 10pcs', 'price': 149, 'desc': 'Ball pens'},\n    {'cat': 'Office Supplies', 'name': 'A4 Paper 500 sheets', 'price': 299, 'desc': 'Printing paper'},\n    {'cat': 'Office Supplies', 'name': 'Stapler', 'price': 199, 'desc': 'Heavy duty'},\n    {'cat': 'Office Supplies', 'name': 'File Folders 10pc', 'price': 249, 'desc': 'Document folders'},\n    {'cat': 'Office Supplies', 'name': 'Desk Organizer', 'price': 599, 'desc': 'Multi-compartment'},\n    {'cat': 'Pet Supplies', 'name': 'Dog Food 3kg', 'price': 899, 'desc': 'Premium food'},\n    {'cat': 'Pet Supplies', 'name': 'Cat Litter 5kg', 'price': 499, 'desc': 'Odor control'},\n    {'cat': 'Pet Supplies', 'name': 'Pet Bowl Set', 'price': 299, 'desc': 'Stainless steel'},\n    {'cat': 'Pet Supplies', 'name': 'Dog Collar', 'price': 249, 'desc': 'Adjustable'},\n    {'cat': 'Pet Supplies', 'name': 'Pet Toy Ball', 'price': 149, 'desc': 'Rubber ball'},\n]\n\nSHOP_NAMES = [\n    'Fresh Mart', 'Quick Stop', 'City Store', 'Smart Shop', 'Easy Buy',\n    'Metro Bazaar', 'Corner Shop', 'Daily Needs', 'Express Store', 'Local Market',\n    'Super Save', 'Prime Retail', 'Best Buy Store', 'Value Shop', 'Mega Mart',\n    'Happy Store', 'Top Shop', 'Quality Bazaar', 'Trade Point', 'Shop Hub'\n]\n\nREVIEWS_COMMENTS = {\n    5: ['Excellent product!', 'Highly recommended!', 'Best purchase ever!', 'Amazing quality!'],\n    4: ['Very good', 'Worth the money', 'Good quality', 'Happy with purchase'],\n    3: ['Decent product', 'Okay for the price', 'Average quality'],\n    2: ['Not as expected', 'Could be better', 'Disappointed'],\n    1: ['Poor quality', 'Waste of money', 'Very disappointed']\n}\n\ndef generate_nearby_coordinates(base_lat, base_lng, radius_km=5):\n    offset_lat = (random.random() - 0.5) * (radius_km / 111.0) * 2\n    offset_lng = (random.random() - 0.5) * (radius_km / (111.0 * 0.9)) * 2\n    return base_lat + offset_lat, base_lng + offset_lng\n\ndef seed_data():\n    with app.app_context():\n        print(\"Creating database tables...\")\n        db.create_all()\n        \n        print(\"Clearing existing data...\")\n        Review.query.delete()\n        Product.query.delete()\n        User.query.filter_by(user_type='seller').delete()\n        User.query.filter_by(user_type='buyer').delete()\n        db.session.commit()\n        \n        print(\"Creating 15 sellers (exactly 3 from Bareilly, UP)...\")\n        sellers = []\n        seller_counter = 1\n        \n        for i in range(3):\n            city = CITIES[0]\n            shop_lat, shop_lng = generate_nearby_coordinates(city['lat'], city['lng'], radius_km=8)\n            seller_id = f\"SELLER{seller_counter:03d}\"\n            \n            seller = User(\n                user_id=seller_id,\n                email=f\"seller{seller_counter}@buddyshop.com\",\n                password_hash=generate_password_hash('seller123'),\n                full_name=f\"Seller {seller_counter}\",\n                phone=f\"98765{random.randint(10000, 99999)}\",\n                user_type='seller',\n                login_status=0,\n                shop_name=f\"{random.choice(SHOP_NAMES)} - {city['name']}\",\n                shop_address=f\"{random.randint(1, 999)} Civil Lines, {city['name']}, Uttar Pradesh\",\n                shop_latitude=shop_lat,\n                shop_longitude=shop_lng,\n                shop_city=city['name'],\n                shop_pincode=f\"2430{random.randint(10, 99)}\"\n            )\n            db.session.add(seller)\n            sellers.append(seller)\n            seller_counter += 1\n        \n        for city_idx in range(1, len(CITIES)):\n            city = CITIES[city_idx]\n            sellers_in_city = 3\n            \n            for shop_idx in range(sellers_in_city):\n                shop_lat, shop_lng = generate_nearby_coordinates(city['lat'], city['lng'], radius_km=10)\n                seller_id = f\"SELLER{seller_counter:03d}\"\n                \n                seller = User(\n                    user_id=seller_id,\n                    email=f\"seller{seller_counter}@buddyshop.com\",\n                    password_hash=generate_password_hash('seller123'),\n                    full_name=f\"Seller {seller_counter}\",\n                    phone=f\"98765{random.randint(10000, 99999)}\",\n                    user_type='seller',\n                    login_status=0,\n                    shop_name=f\"{random.choice(SHOP_NAMES)} - {city['name']}\",\n                    shop_address=f\"{random.randint(1, 999)} MG Road, {city['name']}\",\n                    shop_latitude=shop_lat,\n                    shop_longitude=shop_lng,\n                    shop_city=city['name'],\n                    shop_pincode=f\"{random.randint(100000, 999999)}\"\n                )\n                db.session.add(seller)\n                sellers.append(seller)\n                seller_counter += 1\n        \n        db.session.commit()\n        print(f\"Created {len(sellers)} sellers\")\n        \n        print(\"Creating ~1000 products...\")\n        products = []\n        product_counter = 1\n        \n        while product_counter <= 1000:\n            seller = random.choice(sellers)\n            prod_data = random.choice(PRODUCTS_CATALOG)\n            \n            product_id = f\"PROD{product_counter:04d}\"\n            total_stock = random.randint(10, 200)\n            online_stock = random.randint(int(total_stock * 0.3), total_stock)\n            \n            price_variation = random.randint(-30, 50)\n            final_price = max(prod_data['price'] + price_variation, 10)\n            \n            product = Product(\n                product_id=product_id,\n                seller_id=seller.user_id,\n                name=prod_data['name'],\n                description=prod_data['desc'],\n                category=prod_data['cat'],\n                price=final_price,\n                stock=total_stock,\n                online_stock=online_stock,\n                images=json.dumps([f\"https://via.placeholder.com/500x500?text={prod_data['name'].replace(' ', '+')}\"]),\n                is_visible=1,\n                rating=0.0,\n                rating_count=0\n            )\n            db.session.add(product)\n            products.append(product)\n            product_counter += 1\n            \n            if product_counter % 100 == 0:\n                db.session.commit()\n                print(f\"Created {product_counter} products...\")\n        \n        db.session.commit()\n        print(f\"Created {len(products)} products\")\n        \n        print(\"Creating sample buyers...\")\n        buyers = []\n        for i in range(20):\n            buyer_id = f\"BUYER{i+1:03d}\"\n            buyer = User(\n                user_id=buyer_id,\n                email=f\"buyer{i+1}@buddyshop.com\",\n                password_hash=generate_password_hash('buyer123'),\n                full_name=f\"Buyer {i+1}\",\n                phone=f\"98765{random.randint(10000, 99999)}\",\n                user_type='buyer',\n                login_status=0\n            )\n            db.session.add(buyer)\n            buyers.append(buyer)\n        \n        db.session.commit()\n        print(f\"Created {len(buyers)} buyers\")\n        \n        print(\"Creating reviews for products...\")\n        review_count = 0\n        for product in random.sample(products, min(500, len(products))):\n            num_reviews = random.randint(1, 6)\n            reviewers = random.sample(buyers, min(num_reviews, len(buyers)))\n            \n            total_rating = 0\n            for reviewer in reviewers:\n                rating = random.choices([5, 4, 3, 2, 1], weights=[40, 30, 15, 10, 5])[0]\n                comment = random.choice(REVIEWS_COMMENTS[rating])\n                \n                review = Review(\n                    product_id=product.product_id,\n                    user_id=reviewer.user_id,\n                    rating=rating,\n                    comment=comment\n                )\n                db.session.add(review)\n                total_rating += rating\n                review_count += 1\n            \n            if num_reviews > 0:\n                product.rating = round(total_rating / num_reviews, 1)\n                product.rating_count = num_reviews\n            \n            if review_count % 100 == 0:\n                db.session.commit()\n        \n        db.session.commit()\n        print(f\"Created {review_count} reviews\")\n        \n        print(\"\\n=== Seed Data Created Successfully! ===\")\n        print(f\"Sellers: {len(sellers)} (3 from Bareilly, UP)\")\n        print(f\"Products: {len(products)}\")\n        print(f\"Buyers: {len(buyers)}\")\n        print(f\"Reviews: {review_count}\")\n        print(\"\\nTest Accounts:\")\n        print(\"Seller: seller1@buddyshop.com / seller123 (Bareilly)\")\n        print(\"Seller: seller2@buddyshop.com / seller123 (Bareilly)\")\n        print(\"Buyer: buyer1@buddyshop.com / buyer123\")\n\nif __name__ == '__main__':\n    seed_data()\n","size_bytes":18056},"FlipkartClone/static/js/main.js":{"content":"function showNotification(message, type = 'success') {\n    const notification = document.getElementById('notification');\n    notification.textContent = message;\n    notification.className = 'notification ' + type + ' show';\n    \n    setTimeout(() => {\n        notification.classList.remove('show');\n    }, 3000);\n}\n\nasync function logoutRequest() {\n    if (!confirm('Are you sure you want to logout?')) {\n        return;\n    }\n    \n    try {\n        const response = await fetch('/logout', {\n            method: 'POST'\n        });\n        \n        const data = await response.json();\n        \n        if (data.success) {\n            showNotification(data.message, 'success');\n            setTimeout(() => {\n                window.location.href = '/';\n            }, 1000);\n        } else {\n            showNotification(data.message, 'error');\n        }\n    } catch (error) {\n        showNotification('Logout failed', 'error');\n    }\n}\n\nasync function initFirebase() {\n    try {\n        const response = await fetch('/api/firebase-config');\n        const config = await response.json();\n        \n        if (!config.enabled) {\n            console.log('Firebase not configured. Set FIREBASE_API_KEY and other Firebase environment variables to enable notifications.');\n            return;\n        }\n        \n        if (typeof firebase !== 'undefined') {\n            if (!firebase.apps.length) {\n                firebase.initializeApp(config.firebaseConfig);\n            }\n            \n            if ('serviceWorker' in navigator) {\n                navigator.serviceWorker.register('/static/firebase-messaging-sw.js')\n                    .then((registration) => {\n                        console.log('Service Worker registered');\n                        \n                        const messaging = firebase.messaging();\n                        \n                        messaging.getToken({ \n                            vapidKey: config.vapidKey,\n                            serviceWorkerRegistration: registration \n                        }).then((currentToken) => {\n                            if (currentToken) {\n                                console.log('FCM Token obtained');\n                                fetch('/api/save-fcm-token', {\n                                    method: 'POST',\n                                    headers: {\n                                        'Content-Type': 'application/json'\n                                    },\n                                    body: JSON.stringify({ token: currentToken })\n                                });\n                            } else {\n                                console.log('No registration token available.');\n                            }\n                        }).catch((err) => {\n                            console.log('An error occurred while retrieving token:', err);\n                        });\n                        \n                        messaging.onMessage((payload) => {\n                            console.log('Message received:', payload);\n                            showNotification(payload.notification.body, 'success');\n                        });\n                    })\n                    .catch((err) => {\n                        console.log('Service Worker registration failed:', err);\n                    });\n            }\n        }\n    } catch (error) {\n        console.log('Firebase initialization error:', error);\n    }\n}\n\nif (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', initFirebase);\n} else {\n    initFirebase();\n}\n","size_bytes":3571},"FlipkartClone/replit.md":{"content":"# BuddyShop E-Commerce Platform\n\n## Project Overview\nA comprehensive e-commerce platform similar to BuddyShop, built with Flask backend and modern HTML/CSS/JavaScript frontend. Features include custom token-based authentication, seller product management, shopping cart, order processing, and integrated mapping for delivery addresses.\n\n## Recent Changes\n- **Date: November 9, 2024**\n  - Initial project setup with complete e-commerce functionality\n  - Implemented custom authentication system with email verification\n  - Created responsive UI inspired by BuddyShop\n  - Integrated OpenStreetMap with Leaflet.js for address selection\n  - Set up Firebase Cloud Messaging for push notifications\n\n## Technology Stack\n\n### Backend\n- **Flask**: Web framework for Python\n- **SQLite**: Database for users, products, orders, and cart\n- **Flask-Mail**: Email verification and logout confirmation\n- **APScheduler**: Background task scheduling for temp user cleanup\n- **Werkzeug**: Password hashing and security\n- **Pillow**: Image processing for product uploads\n\n### Frontend\n- **HTML5/CSS3**: Structure and styling\n- **JavaScript (Vanilla)**: Interactive functionality\n- **Leaflet.js**: OpenStreetMap integration for delivery addresses\n- **Firebase SDK**: Push notifications\n- **Font Awesome**: Icons\n\n## Project Architecture\n\n### Database Structure\n- **temp_users**: Temporary user storage with 15-minute expiry for email verification\n- **users**: Main user table with login status tracking\n- **auth_tokens**: Authentication tokens with user ID and login timestamp\n- **products**: Product catalog with seller information\n- **cart**: Shopping cart items\n- **orders**: Order history with delivery information\n- **addresses**: Saved delivery addresses with coordinates\n\n### Authentication System\n1. **Registration**: User data saved to temp database, verification email sent\n2. **Email Verification**: 15-minute window to click link and move to main database\n3. **Login**: Generates unique token based on user ID + login timestamp\n4. **Session**: Token stored in httpOnly cookie for security\n5. **Logout**: Email confirmation required, sets login_status to false\n\n### Key Features\n1. **User Management**: Registration with email verification, token-based auth\n2. **Seller Dashboard**: Add/manage products with image uploads\n3. **Product Catalog**: Browse, search, filter by category\n4. **Shopping Cart**: Add/remove items, quantity management\n5. **Checkout**: Interactive map for address selection using OSM/Leaflet\n6. **Order Tracking**: View order history with delivery status\n7. **Notifications**: Firebase Cloud Messaging for real-time updates\n\n## File Structure\n```\n.\n app.py                  # Main Flask application\n database.py            # Database models and initialization\n auth.py                # Authentication utilities\n templates/             # HTML templates\n    base.html         # Base template with navigation\n    index.html        # Homepage\n    login.html        # Login page\n    register.html     # Registration page\n    verified.html     # Email verification result\n    products.html     # Product listing\n    product_detail.html\n    seller_dashboard.html\n    add_product.html\n    cart.html\n    checkout.html\n    orders.html\n static/\n    css/style.css     # Main stylesheet\n    js/main.js        # JavaScript functionality\n    firebase-messaging-sw.js\n    uploads/          # Product images\n ecommerce.db          # SQLite database\n```\n\n## Environment Variables\n\n### Required for Email Functionality\n- `SESSION_SECRET`: Flask session secret (auto-generated if not set)\n- `MAIL_USERNAME`: SMTP email username\n- `MAIL_PASSWORD`: SMTP email password\n\n### Optional for Firebase Push Notifications\n- `FIREBASE_API_KEY`: Firebase API key\n- `FIREBASE_AUTH_DOMAIN`: Firebase auth domain\n- `FIREBASE_PROJECT_ID`: Firebase project ID\n- `FIREBASE_STORAGE_BUCKET`: Firebase storage bucket\n- `FIREBASE_MESSAGING_SENDER_ID`: Firebase messaging sender ID\n- `FIREBASE_APP_ID`: Firebase app ID\n- `FIREBASE_VAPID_KEY`: Firebase VAPID key for web push\n\nIf not configured, the app gracefully handles missing Firebase config.\n\n## Setup Instructions\n\n### 1. Email Configuration\nTo enable email verification and logout confirmation:\n1. Set up a Gmail account or SMTP server\n2. Add environment variables:\n   - `MAIL_USERNAME`: Your email address\n   - `MAIL_PASSWORD`: App password (for Gmail, create app-specific password)\n\n### 2. Firebase Setup (Optional)\nFor push notifications:\n1. Create a Firebase project at https://console.firebase.google.com\n2. Enable Cloud Messaging\n3. Get your config from Project Settings\n4. Update Firebase config in:\n   - `static/js/main.js`\n   - `static/firebase-messaging-sw.js`\n5. Generate VAPID key from Cloud Messaging settings\n\n### 3. Running the Application\nThe application runs automatically via the configured workflow on port 5000.\n\n## User Workflows\n\n### Buyer Journey\n1. Register  Verify email (15 min window)\n2. Login  Browse products\n3. Add to cart  Checkout with map selection\n4. Place order  Track in Orders page\n\n### Seller Journey\n1. Register as seller  Verify email\n2. Login  Access seller dashboard\n3. Add products with images\n4. Manage inventory\n\n## Security Features\n- Password hashing with Werkzeug\n- HttpOnly cookies for auth tokens\n- CSRF protection via Flask\n- Email verification required\n- Forced logout with email confirmation\n- Secure file upload validation\n\n## API Endpoints\n\n### Authentication\n- `POST /register`: Create temp user, send verification email\n- `GET /verify/<user_id>`: Verify email and move to main DB\n- `POST /login`: Generate auth token, set cookies\n- `POST /logout-request`: Send logout confirmation email\n- `GET /logout-confirm/<user_id>`: Confirm logout\n\n### Products\n- `GET /`: Homepage with featured products\n- `GET /products`: Product listing with filters\n- `GET /product/<product_id>`: Product details\n- `POST /seller/add-product`: Add new product (sellers only)\n- `GET /api/categories`: Get all categories\n\n### Cart & Orders\n- `POST /cart/add`: Add item to cart\n- `GET /cart`: View cart\n- `POST /cart/remove/<cart_id>`: Remove from cart\n- `POST /checkout`: Place order with delivery address\n- `GET /orders`: View order history\n\n## Future Enhancements\n- Payment gateway integration (Stripe/PayPal)\n- Product reviews and ratings\n- Real-time inventory management\n- Admin panel for platform management\n- Advanced product recommendation engine\n- Multi-vendor rating system\n","size_bytes":6704},"replit.md":{"content":"# Buddy-Shop E-Commerce Platform\n\n## Overview\n\nBuddy-Shop is a comprehensive e-commerce platform with a professional cold-war inspired 3D design aesthetic, built with Flask backend and vanilla JavaScript frontend. The platform supports both global e-commerce and local marketplace modes, allowing users to shop from anywhere or discover nearby sellers within a 30km radius. It features a custom token-based authentication system, seller product management, shopping cart functionality, order processing, and integrated map-based address selection.\n\n## Recent Updates (November 2025)\n\n**Complete Design Overhaul - Cold War Professional Theme**\n- Implemented military-inspired color palette: olive greens (#556B2F), burgundy (#6B2C2C), tan/beige (#D4C5B0), and metallic grays\n- Added comprehensive 3D depth effects throughout the UI using multi-layer box shadows and gradients\n- Created stunning onboarding screen with animated logo, military badges, and fade-out transition\n- Rebranded entire application from \"FlipShop\" to \"Buddy-Shop\" with new logo integration\n- Updated all UI components (navbar, buttons, cards, forms) with raised/embossed 3D styling\n- Implemented 3D utility classes: .elevated, .inset, .glossy, .metallic for consistent depth application\n- All gradients and shadows follow the cold-war professional aesthetic with proper depth perception\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Backend Architecture\n\n**Framework & Core Technologies**\n- **Flask**: Python web framework serving as the application backbone\n- **SQLAlchemy ORM**: Database abstraction layer for data management\n- **SQLite**: Lightweight embedded database for data persistence\n- **Werkzeug**: Security utilities for password hashing and file uploads\n\n**Custom Authentication System**\nThe application implements a multi-stage authentication flow:\n1. **Registration Flow**: User data is temporarily stored in a `temp_users` table with 15-minute expiry\n2. **Email Verification**: Users receive verification emails and must confirm within the time window\n3. **User Migration**: Upon verification, data moves from temporary to permanent `users` table\n4. **Token Generation**: Login creates unique tokens combining user ID, timestamp, and random data hashed with SHA-256\n5. **Session Management**: Tokens stored in HTTP-only cookies for security\n6. **Forced Logout**: Email confirmation required for logout, setting `login_status` flag to false\n\n**Rationale**: This custom system provides granular control over user lifecycle, prevents spam registrations through email verification, and adds extra security through email-confirmed logout. Alternative considered was using Flask-Login, but custom solution offers more flexibility for multi-device session management.\n\n**Background Task Scheduler**\n- **APScheduler**: Runs cleanup jobs every 5 minutes to remove expired temporary users and logout tokens\n- Prevents database bloat from abandoned registrations\n\n### Frontend Architecture\n\n**Technology Stack**\n- Pure HTML5/CSS3/JavaScript (no frontend framework)\n- Leaflet.js for interactive maps with OpenStreetMap integration\n- Firebase SDK for push notifications\n- Font Awesome for iconography\n\n**Rationale**: Vanilla JavaScript chosen for simplicity and performance. No build step required, faster initial load times, and easier deployment. Considered React/Vue but deemed unnecessary for the scope.\n\n**Key Frontend Features**\n1. **Dual Mode System**: Toggle between global e-commerce and local marketplace (30km radius)\n2. **Interactive Address Selection**: Click-to-select on map with reverse geocoding\n3. **Real-time Cart Management**: Asynchronous cart updates without page reload\n4. **Responsive Design**: Mobile-first approach with flexible grid layouts\n\n### Database Schema Design\n\n**Core Tables**\n- `temp_users`: Temporary storage for unverified registrations (15-min TTL)\n- `users`: Permanent user accounts with seller shop location data\n- `auth_tokens`: Session tokens linked to users with login timestamps\n- `logout_tokens`: Email-confirmed logout tokens with expiry\n- `products`: Product catalog with seller references, images stored as JSON array\n- `cart`: Shopping cart items linked to users and products\n- `orders`: Order records with JSON-serialized product lists\n- `addresses`: Saved delivery addresses with geocoordinates\n\n**Design Decisions**\n- Separate temporary and permanent user tables prevent polluting main user base\n- Shop location fields (latitude, longitude, city, pincode) enable radius-based local search\n- JSON fields for product images and order items provide flexibility without additional tables\n- FCM token field in users table supports push notifications\n\n**Alternative Considered**: PostgreSQL with proper relational design for order items. Chose SQLite with JSON for simplicity and portability in development. Migration path exists for production scaling.\n\n### File Upload System\n\n**Configuration**\n- Upload folder: `static/uploads`\n- Allowed formats: PNG, JPG, JPEG, GIF, WEBP\n- Maximum file size: 16MB\n- Multiple image upload support per product\n\n**Processing**: Werkzeug's `secure_filename` sanitizes uploads, files stored with original names in upload directory, paths stored as JSON array in database.\n\n### Email System\n\n**Flask-Mail Integration**\n- SMTP server: Gmail (configurable)\n- TLS encryption enabled\n- Use cases: Email verification, logout confirmation, password reset\n\n**Configuration**: Supports environment variables for credentials (`MAIL_USERNAME`, `MAIL_PASSWORD`). Falls back gracefully if not configured, showing warnings but allowing app to function.\n\n## External Dependencies\n\n### Third-Party APIs & Services\n\n**OpenStreetMap & Leaflet.js**\n- **Purpose**: Interactive map display and address selection\n- **Integration**: Client-side JavaScript library rendering OSM tiles\n- **Features**: Click-to-select location, reverse geocoding via Nominatim API\n- **Rationale**: Free, open-source alternative to Google Maps. No API keys required. Lightweight integration.\n\n**Firebase Cloud Messaging (FCM)**\n- **Purpose**: Push notifications for order updates and real-time alerts\n- **Configuration**: Requires Firebase project setup with API keys\n- **Implementation**: Service worker for background message handling\n- **Status**: Optional - app functions without Firebase configuration\n\n**Nominatim Reverse Geocoding API**\n- **Purpose**: Convert latitude/longitude to human-readable addresses\n- **Provider**: OpenStreetMap's geocoding service\n- **Usage**: Address lookup during map-based selection\n- **Rate Limits**: Subject to Nominatim usage policy\n\n### Python Package Dependencies\n\n**Core Dependencies**\n- `flask`: Web framework\n- `flask-sqlalchemy`: ORM integration\n- `flask-mail`: Email functionality\n- `werkzeug`: Security and utilities\n- `apscheduler`: Background job scheduling\n- `pillow`: Image processing (for future enhancements)\n\n**Database**: SQLite (no external database server required)\n\n### Frontend Libraries (CDN-loaded)\n\n- **Leaflet.js** (v1.9.4): Map rendering\n- **Font Awesome** (v6.4.0): Icon library\n- **Firebase SDK** (v10.7.1): Push notifications\n\n**Rationale for CDN**: Reduces deployment complexity, leverages browser caching, faster updates. Alternative was npm/bundler approach but adds build complexity.\n\n### Environment Variables\n\n**Required for Full Functionality**\n- `MAIL_USERNAME`: SMTP email address\n- `MAIL_PASSWORD`: SMTP password or app-specific token\n- `SESSION_SECRET`: Flask session encryption key (auto-generated if missing)\n\n**Optional**\n- Firebase configuration keys (for push notifications)\n- Custom SMTP server settings\n\n### SMTP Provider Options\n\n**Current Default**: Gmail with app passwords\n**Alternatives Supported**: Any SMTP server (SendGrid, Mailgun, custom)\n**Fallback Behavior**: App warns about missing email config but remains functional for core shopping features","size_bytes":7918},"FlipkartClone/database.py":{"content":"from models import db, TempUser, LogoutToken\nfrom datetime import datetime\nfrom flask import current_app\n\ndef init_db(app):\n    with app.app_context():\n        db.create_all()\n\ndef cleanup_expired_temp_users():\n    from app import app\n    with app.app_context():\n        try:\n            TempUser.query.filter(TempUser.expires_at < datetime.utcnow()).delete()\n            LogoutToken.query.filter(LogoutToken.expires_at < datetime.utcnow()).delete()\n            db.session.commit()\n        except Exception as e:\n            db.session.rollback()\n            print(f\"Error cleaning up expired users: {e}\")\n","size_bytes":606},"FlipkartClone/services/route_planner.py":{"content":"import os\nimport json\nimport logging\nfrom google import genai\nfrom google.genai import types\nfrom models import db, RoutePlan, RoutePlanStop\nfrom services.geolocation import haversine_distance\n\nlogging.basicConfig(level=logging.DEBUG)\nlogger = logging.getLogger(__name__)\n\ntry:\n    client = genai.Client(api_key=\"\")\nexcept Exception as e:\n    logger.error(f\"Failed to initialize Gemini client: {e}\")\n    client = None\n\n\ndef optimize_shopping_route(user_id,\n                            origin_lat,\n                            origin_lng,\n                            shopping_list,\n                            destination_lat=None,\n                            destination_lng=None):\n    \"\"\"\n    Optimize shopping route using Gemini API\n    shopping_list: list of dicts with {seller, product, distance_km}\n    Returns optimized route plan\n    \"\"\"\n    if not client:\n        logger.error(\"Gemini client not initialized\")\n        return None\n\n    if not shopping_list:\n        return None\n\n    request_data = {\n        'origin': {\n            'lat': origin_lat,\n            'lng': origin_lng\n        },\n        'destination': {\n            'lat': destination_lat,\n            'lng': destination_lng\n        } if destination_lat else None,\n        'stops': []\n    }\n\n    for item in shopping_list:\n        request_data['stops'].append({\n            'seller_id':\n            item['seller'].user_id,\n            'seller_name':\n            item['seller'].shop_name or item['seller'].full_name,\n            'product_name':\n            item['product'].name,\n            'product_id':\n            item['product'].product_id,\n            'location': {\n                'lat': item['seller'].shop_latitude,\n                'lng': item['seller'].shop_longitude\n            },\n            'distance_from_origin':\n            item['distance_km']\n        })\n\n    prompt = f\"\"\"You are a route optimization assistant. Given a shopping list with multiple store locations, \noptimize the route to minimize total travel distance.\n\nOrigin: ({origin_lat}, {origin_lng})\n{f\"Destination: ({destination_lat}, {destination_lng})\" if destination_lat else \"Return to origin\"}\n\nShopping Stops:\n{json.dumps(request_data['stops'], indent=2)}\n\nPlease provide an optimized route order that minimizes total travel distance. Consider:\n1. Proximity to each other\n2. Logical path from origin to destination\n3. Avoiding backtracking\n\nRespond with a JSON array of stop indices in the optimal order. For example: [2, 0, 3, 1]\n\"\"\"\n\n    try:\n        response = client.models.generate_content(\n            model=\"gemini-2.0-flash-exp\",\n            contents=prompt,\n            config=types.GenerateContentConfig(\n                response_mime_type=\"application/json\"))\n\n        optimized_order = json.loads(response.text)\n\n        route_plan = RoutePlan(user_id=user_id,\n                               origin_lat=origin_lat,\n                               origin_lng=origin_lng,\n                               destination_lat=destination_lat,\n                               destination_lng=destination_lng,\n                               gemini_request=json.dumps(request_data),\n                               gemini_response=response.text,\n                               status='active')\n        db.session.add(route_plan)\n        db.session.flush()\n\n        for order_idx, stop_idx in enumerate(optimized_order):\n            if isinstance(stop_idx,\n                          int) and 0 <= stop_idx < len(shopping_list):\n                item = shopping_list[stop_idx]\n                stop = RoutePlanStop(route_plan_id=route_plan.id,\n                                     seller_id=item['seller'].user_id,\n                                     product_id=item['product'].product_id,\n                                     stop_order=order_idx + 1,\n                                     shop_lat=item['seller'].shop_latitude,\n                                     shop_lng=item['seller'].shop_longitude)\n                db.session.add(stop)\n\n        db.session.commit()\n\n        return {\n            'route_plan_id':\n            route_plan.id,\n            'optimized_order':\n            optimized_order,\n            'stops': [\n                shopping_list[i] for i in optimized_order\n                if isinstance(i, int) and 0 <= i < len(shopping_list)\n            ]\n        }\n\n    except Exception as e:\n        logger.error(f\"Route optimization failed: {e}\")\n        db.session.rollback()\n        return fallback_route_optimization(user_id, origin_lat, origin_lng,\n                                           shopping_list, destination_lat,\n                                           destination_lng)\n\n\ndef fallback_route_optimization(user_id,\n                                origin_lat,\n                                origin_lng,\n                                shopping_list,\n                                destination_lat=None,\n                                destination_lng=None):\n    \"\"\"Simple nearest-neighbor route optimization when Gemini fails\"\"\"\n    if not shopping_list:\n        return None\n\n    remaining = shopping_list.copy()\n    optimized = []\n    current_lat, current_lng = origin_lat, origin_lng\n\n    while remaining:\n        nearest = min(\n            remaining,\n            key=lambda x: haversine_distance(current_lat, current_lng, x[\n                'seller'].shop_latitude, x['seller'].shop_longitude))\n        optimized.append(nearest)\n        remaining.remove(nearest)\n        current_lat = nearest['seller'].shop_latitude\n        current_lng = nearest['seller'].shop_longitude\n\n    return {\n        'route_plan_id': None,\n        'optimized_order': list(range(len(optimized))),\n        'stops': optimized,\n        'fallback': True\n    }\n\n\ndef get_route_plan(route_plan_id):\n    \"\"\"Retrieve a route plan with its stops\"\"\"\n    route_plan = RoutePlan.query.get(route_plan_id)\n    if not route_plan:\n        return None\n\n    stops = RoutePlanStop.query.filter_by(\n        route_plan_id=route_plan_id).order_by(RoutePlanStop.stop_order).all()\n\n    return {'route_plan': route_plan, 'stops': stops}\n","size_bytes":6070}},"version":2}